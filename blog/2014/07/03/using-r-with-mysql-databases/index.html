
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Using R with MySQL Databases - Jason A. French</title>
  <meta name="author" content="Jason A. French">

  
  <meta name="description" content="Overview When I began using R, like most researchers I kept all my data in some combination
of R&#8217;s native data.frame
format or a CSV file that &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://frenchja.github.com/blog/2014/07/03/using-r-with-mysql-databases/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Jason A. French" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<!-- MathJax -->
<script type="text/javascript"
  src="https://c328740.ssl.cf1.rackcdn.com/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    var pluginUrl =
     '//www.google-analytics.com/plugins/ga/inpage_linkid.js';
    _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
    _gaq.push(['_setAccount', 'UA-29782432-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Jason A. French</a></h1>
  
    <h2>Northwestern University</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:frenchja.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/files/JFrenchCV.pdf">CV</a></li>
  <li><a href="https://sapa-project.org">Projects</a></li>
  <li><a href="/pubs">Pubs</a></li>
  <li><a href="https://personality-project.org/pmc.html">Lab</a></li>
  <li><a href="/tutorials">R Tutorials</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Using R With MySQL Databases</h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-07-03T10:58:00-07:00" pubdate data-updated="true">Jul 3<span>rd</span>, 2014</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><h2>Overview</h2>

<p>When I began using R, like most researchers I kept all my data in some combination
of R&#8217;s native <a href="http://stat.ethz.ch/R-manual/R-devel/library/base/html/data.frame.html">data.frame</a>
format or a <a href="http://en.wikipedia.org/wiki/Comma-separated_values">CSV</a> file that my analysis would continually read.
However, as I began to analyze big datasets at the <a href="https://sapa-project.org">SAPA Project</a>
and at <a href="http://insightdatascience.com/">Insight</a>,
I realized that there is a lot of value to instead keeping your data in a MySQL database.
This post will detail a few advantages of using a database to store data and run through a
basic example of using R to transfer data to MySQL.</p>

<!-- more -->


<h3>Memory Efficiency</h3>

<p>For example, relational databases are better at handling large datasets and are more efficient
at storing data than CSVs.
When reading data stored in a data.frame or CSV file, the data must all fit <em>in memory</em>.
All of your data may not fit easily in memory, as is the case if you have a
large dataset or are cursed with an older computers with &lt;= 4GB of RAM.
In these cases, every time you load your dataset or do an expensive operation
your computer will slow to a painful crawl as your hard drives grind while your operating system
switches to using <a href="http://en.wikipedia.org/wiki/Virtual_memory">virtual memory</a>, rather than RAM.
You can get around this by using random sampling to sample a smaller subset (or multiple subsets
if you want to bootstrap), but you can also use this technique on a SQL database. The advantage is that SQL databases
only load the data you&#8217;re working with into the machine&#8217;s RAM.</p>

<h3>Safety and Security</h3>

<p>Two additional reasons I prefer SQL databases are safety and security. Services such as
Amazon&#8217;s RDS (i.e., Relational Database Service) offer frequent backups and easily replication
across machines. This means that if your machine dies, your data is safe and uncorrupted. If I were storing
data in an .Rdata file, I&#8217;d have to rely on my OS (e.g., Time Machine) or a cloud-based storage solution
(e.g., Dropbox or CrashPlan) to backup my data. Worse, if I were storing my data in an Excel database and Excel
crashed, I may risk losing years of progress.</p>

<p>Furthermore, I can give a collaborator access
to only needed portions of the data by locking down their SQL username to certain tables
and operations. By limiting access, we limit risk of corruption and overwriting years of progress.</p>

<h3>Scalable as your need grows</h3>

<p>Last, I find relational databases such as MySQL to be more scalable. In the case of using Amazon&#8217;s RDS,
you can buy as much storage or bandwidth as you need to complete your analysis, dissertation,
or build your web app. If I need multiple nodes or machines to analyze the data, I don&#8217;t need to keep a copy of
the data on each machine.  I simply pass the SQL authentication parameters to each machine and the
data is accessed from a central location.</p>

<p>So let&#8217;s begin by setting up a <a href="http://aws.amazon.com/rds/free/">Free-Tier RDS service</a> on Amazon and then move some
data from R to the RDS database.</p>

<h2>Setting up an RDS Instance</h2>

<p>Amazon currently offers a Free Tier for their RDS storage.  It offers:</p>

<ul>
<li>Enough hours to run a DB Instance continuously each month,</li>
<li>20 GB of database storage,</li>
<li>10 million I/O operations, and</li>
<li>automated database backups.</li>
</ul>


<p>To setup an RDS instance:</p>

<ol>
<li>Sign into the AWS Management Console.</li>
<li>Select &#8216;RDS&#8217; under the &#8216;Database&#8217; group.</li>
<li>Click &#8216;Launch DB Instance&#8217;.</li>
<li>Select &#8216;MySQL&#8217; for the database engine.</li>
<li>Select &#8216;No&#8217; when asked if you intend to use the database for production purposes. Accidentally selecting &#8216;Yes&#8217; could result in hefty fees.</li>
<li>For &#8216;Instance Class&#8217;, select &#8216;db.t1.micro&#8217;, &#8216;No&#8217; for &#8216;Multi-AZ Deployment&#8217;, and 20 GB for &#8216;Allocated Storage&#8217;.</li>
<li>Click &#8216;Next&#8217; and launch your RDS instance.</li>
</ol>


<p>At this point, you should have a blank RDS database with a master username and password combination. Be sure to test that you can connect - I suggest using <a href="http://www.sequelpro.com/">Sequel Pro</a>. <em>If you can&#8217;t connect,
you may need to open up port 3306 in your EC2 Security Group</em>.</p>

<p>Click on your new RDS Instance to get the hostname to connect to and note the database name:</p>

<p><img class="center" src="/images/rds1.png"></p>

<p>Fire up Sequel Pro and test out your new database.  If you want to connect using SSL, you&#8217;ll need the SSH key you generated when
you first created your EC2 instance (not covered here).</p>

<p><img class="center" src="/images/rds2.png"></p>

<h2>Installing the RMySQL package</h2>

<p>Previously, I found installing <a href="">RMySQL</a> to be very difficult when I was using MacPorts.  However,
having switched to <a href="http://brew.sh/">Homebrew</a> on my new machine, RMySQL found all my MySQL headers and libraries as
<a href="http://brew.sh/">Homebrew</a> uses the <code>/usr/local</code> directory to store your software, which is already in your BASH $PATH.</p>

<p>Before compiling RMySQL, first compile MySQL using Homebrew:</p>

<figure class='code'><figcaption><span>Installing MySQL using Homebrew</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c"># If you haven&#39;t already, install Homebrew:</span>
</span><span class='line'><span class="c"># ruby -e &quot;$(curl -fsSL https://raw.github.com/Homebrew/homebrew/go/install)&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="c"># Install MySQL</span>
</span><span class='line'>brew install mysql
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>Installing MySQL using Homebrew</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="o">==</span>&gt; Downloading https://downloads.sf.net/project/machomebrew/Bottles/mysql-5.6.1
</span><span class='line'>Already downloaded: /Library/Caches/Homebrew/mysql-5.6.19.mavericks.bottle.tar.gz
</span><span class='line'><span class="o">==</span>&gt; Pouring mysql-5.6.19.mavericks.bottle.tar.gz
</span><span class='line'><span class="o">==</span>&gt; Caveats
</span><span class='line'>A <span class="s2">&quot;/etc/my.cnf&quot;</span> from another install may interfere with a Homebrew-built
</span><span class='line'>server starting up correctly.
</span><span class='line'>
</span><span class='line'>To connect:
</span><span class='line'>    mysql -uroot
</span><span class='line'>
</span><span class='line'>To have launchd start mysql at login:
</span><span class='line'>    ln -sfv /usr/local/opt/mysql/*.plist ~/Library/LaunchAgents
</span><span class='line'>Then to load mysql now:
</span><span class='line'>    launchctl load ~/Library/LaunchAgents/homebrew.mxcl.mysql.plist
</span><span class='line'>Or, <span class="k">if </span>you don<span class="err">&#39;</span>t want/need launchctl, you can just run:
</span><span class='line'>    mysql.server <span class="nv">start</span>
</span><span class='line'><span class="o">==</span>&gt; Summary
</span><span class='line'>üç∫  /usr/local/Cellar/mysql/5.6.19: 9536 files, 338M
</span></code></pre></td></tr></table></div></figure>


<p>Next, compile RMySQL from source:</p>

<figure class='code'><figcaption><span>Compiling RMySQL</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'>install.packages<span class="p">(</span><span class="s">&#39;RMySQL&#39;</span><span class="p">,</span> type <span class="o">=</span> <span class="s">&#39;source&#39;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>Compiling RMySQL</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'>trying URL <span class="s">&#39;http://cran.rstudio.com/src/contrib/RMySQL_0.9-3.tar.gz&#39;</span>
</span><span class='line'>Content type <span class="s">&#39;application/x-gzip&#39;</span> length <span class="m">165363</span> bytes <span class="p">(</span><span class="m">161</span> Kb<span class="p">)</span>
</span><span class='line'>opened URL
</span><span class='line'><span class="o">==================================================</span>
</span><span class='line'>downloaded <span class="m">161</span> Kb
</span><span class='line'>
</span><span class='line'><span class="o">*</span> installing <span class="o">*</span>source<span class="o">*</span> package ‚ÄòRMySQL‚Äô <span class="kc">...</span>
</span><span class='line'><span class="o">**</span> package ‚ÄòRMySQL‚Äô successfully unpacked and MD5 sums checked
</span><span class='line'>checking <span class="kr">for</span> gcc... gcc
</span><span class='line'>checking <span class="kr">for</span> C compiler default output file name... a.out
</span><span class='line'>checking whether the C compiler works... yes
</span><span class='line'>checking whether we are cross compiling... no
</span><span class='line'>checking <span class="kr">for</span> suffix of executables...
</span><span class='line'>checking <span class="kr">for</span> suffix of object files... o
</span><span class='line'>checking whether we are using the GNU C compiler... yes
</span><span class='line'>checking whether gcc accepts <span class="o">-</span>g... yes
</span><span class='line'>checking <span class="kr">for</span> gcc option to accept ANSI C... none needed
</span><span class='line'>checking how to run the C preprocessor... gcc <span class="o">-</span>E
</span><span class='line'>checking <span class="kr">for</span> compress <span class="kr">in</span> <span class="o">-</span>lz... yes
</span><span class='line'>checking <span class="kr">for</span> getopt_long <span class="kr">in</span> <span class="o">-</span>lc... yes
</span><span class='line'>checking <span class="kr">for</span> mysql_init <span class="kr">in</span> <span class="o">-</span>lmysqlclient... yes
</span><span class='line'>checking <span class="kr">for</span> egrep... grep <span class="o">-</span>E
</span><span class='line'>checking <span class="kr">for</span> ANSI C header files...
</span><span class='line'>rm<span class="o">:</span> conftest.dSYM<span class="o">:</span> is a directory
</span><span class='line'>rm<span class="o">:</span> conftest.dSYM<span class="o">:</span> is a directory
</span><span class='line'>yes
</span><span class='line'>checking <span class="kr">for</span> sys<span class="o">/</span>types.h... yes
</span><span class='line'>checking <span class="kr">for</span> sys<span class="o">/</span>stat.h... yes
</span><span class='line'>checking <span class="kr">for</span> stdlib.h... yes
</span><span class='line'>checking <span class="kr">for</span> string.h... yes
</span><span class='line'>checking <span class="kr">for</span> memory.h... yes
</span><span class='line'>checking <span class="kr">for</span> strings.h... yes
</span><span class='line'>checking <span class="kr">for</span> inttypes.h... yes
</span><span class='line'>checking <span class="kr">for</span> stdint.h... yes
</span><span class='line'>checking <span class="kr">for</span> unistd.h... yes
</span><span class='line'>checking mysql.h usability... no
</span><span class='line'>checking mysql.h presence... no
</span><span class='line'>checking <span class="kr">for</span> mysql.h... no
</span><span class='line'>checking <span class="o">/</span>usr<span class="o">/</span>local<span class="o">/</span>include<span class="o">/</span>mysql<span class="o">/</span>mysql.h usability... yes
</span><span class='line'>checking <span class="o">/</span>usr<span class="o">/</span>local<span class="o">/</span>include<span class="o">/</span>mysql<span class="o">/</span>mysql.h presence... yes
</span><span class='line'>checking <span class="kr">for</span> <span class="o">/</span>usr<span class="o">/</span>local<span class="o">/</span>include<span class="o">/</span>mysql<span class="o">/</span>mysql.h... yes
</span><span class='line'>configure<span class="o">:</span> creating .<span class="o">/</span>config.status
</span><span class='line'>config.status<span class="o">:</span> creating src<span class="o">/</span>Makevars
</span><span class='line'><span class="o">**</span> libs
</span><span class='line'>clang <span class="o">-</span>I<span class="o">/</span>Library<span class="o">/</span>Frameworks<span class="o">/</span>R.framework<span class="o">/</span>Resources<span class="o">/</span>include <span class="o">-</span>DNDEBUG <span class="o">-</span>I<span class="o">/</span>usr<span class="o">/</span>local<span class="o">/</span>include<span class="o">/</span>mysql <span class="o">-</span>I<span class="o">/</span>usr<span class="o">/</span>local<span class="o">/</span>include <span class="o">-</span>I<span class="o">/</span>usr<span class="o">/</span>local<span class="o">/</span>include<span class="o">/</span>freetype2 <span class="o">-</span>I<span class="o">/</span>opt<span class="o">/</span>X11<span class="o">/</span>include    <span class="o">-</span>fPIC  <span class="o">-</span>Wall <span class="o">-</span>mtune<span class="o">=</span>core2 <span class="o">-</span>g <span class="o">-</span>O2  <span class="o">-</span>c RS<span class="o">-</span>DBI.c <span class="o">-</span>o RS<span class="o">-</span>DBI.o
</span><span class='line'>clang <span class="o">-</span>I<span class="o">/</span>Library<span class="o">/</span>Frameworks<span class="o">/</span>R.framework<span class="o">/</span>Resources<span class="o">/</span>include <span class="o">-</span>DNDEBUG <span class="o">-</span>I<span class="o">/</span>usr<span class="o">/</span>local<span class="o">/</span>include<span class="o">/</span>mysql <span class="o">-</span>I<span class="o">/</span>usr<span class="o">/</span>local<span class="o">/</span>include <span class="o">-</span>I<span class="o">/</span>usr<span class="o">/</span>local<span class="o">/</span>include<span class="o">/</span>freetype2 <span class="o">-</span>I<span class="o">/</span>opt<span class="o">/</span>X11<span class="o">/</span>include    <span class="o">-</span>fPIC  <span class="o">-</span>Wall <span class="o">-</span>mtune<span class="o">=</span>core2 <span class="o">-</span>g <span class="o">-</span>O2  <span class="o">-</span>c RS<span class="o">-</span>MySQL.c <span class="o">-</span>o RS<span class="o">-</span>MySQL.o
</span><span class='line'>clang <span class="o">-</span>dynamiclib <span class="o">-</span>Wl<span class="p">,</span><span class="o">-</span>headerpad_max_install_names <span class="o">-</span>undefined dynamic_lookup <span class="o">-</span>single_module <span class="o">-</span>multiply_defined suppress <span class="o">-</span>L<span class="o">/</span>usr<span class="o">/</span>local<span class="o">/</span>lib <span class="o">-</span>o RMySQL.so RS<span class="o">-</span>DBI.o RS<span class="o">-</span>MySQL.o <span class="o">-</span>lmysqlclient <span class="o">-</span>lz <span class="o">-</span><span class="k-Variable">F</span><span class="o">/</span>Library<span class="o">/</span>Frameworks<span class="o">/</span>R.framework<span class="o">/</span>.. <span class="o">-</span>framework R <span class="o">-</span>Wl<span class="p">,</span><span class="o">-</span>framework <span class="o">-</span>Wl<span class="p">,</span>CoreFoundation
</span><span class='line'>installing to <span class="o">/</span>Library<span class="o">/</span>Frameworks<span class="o">/</span>R.framework<span class="o">/</span>Versions<span class="o">/</span><span class="m">3.1</span><span class="o">/</span>Resources<span class="o">/</span>library<span class="o">/</span>RMySQL<span class="o">/</span>libs
</span><span class='line'><span class="o">**</span> R
</span><span class='line'><span class="o">**</span> inst
</span><span class='line'><span class="o">**</span> preparing package <span class="kr">for</span> lazy loading
</span><span class='line'>Creating a generic <span class="kr">function</span> <span class="kr">for</span> ‚Äòformat‚Äô from package ‚Äòbase‚Äô <span class="kr">in</span> package ‚ÄòRMySQL‚Äô
</span><span class='line'>Creating a generic <span class="kr">function</span> <span class="kr">for</span> ‚Äòprint‚Äô from package ‚Äòbase‚Äô <span class="kr">in</span> package ‚ÄòRMySQL‚Äô
</span><span class='line'><span class="o">**</span> help
</span><span class='line'><span class="o">***</span> installing help indices
</span><span class='line'><span class="o">**</span> building package indices
</span><span class='line'><span class="o">**</span> testing <span class="kr">if</span> installed package can be loaded
</span><span class='line'><span class="o">*</span> DONE <span class="p">(</span>RMySQL<span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Transferring Existing Data to/from MySQL</h2>

<p>Having a database is useless unless we can easily convert our existing data.frames
into MySQL tables.  Let&#8217;s try this using the <code>Thurstone</code> dataset from the Bill&#8217;s <code>psych</code> package:</p>

<figure class='code'><figcaption><span>Moving Thurstone to RDS</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'>library<span class="p">(</span>RMySQL<span class="p">)</span>
</span><span class='line'>library<span class="p">(</span>psych<span class="p">)</span>
</span><span class='line'>con <span class="o">&lt;-</span> dbConnect<span class="p">(</span>MySQL<span class="p">(),</span>
</span><span class='line'>    user <span class="o">=</span> <span class="s">&#39;RDSUser&#39;</span><span class="p">,</span>
</span><span class='line'>    password <span class="o">=</span> <span class="s">&#39;YourPass&#39;</span><span class="p">,</span>
</span><span class='line'>    host <span class="o">=</span> <span class="s">&#39;RDS Host&#39;</span><span class="p">,</span>
</span><span class='line'>    dbname<span class="o">=</span><span class="s">&#39;YourDB&#39;</span><span class="p">)</span>
</span><span class='line'>dbWriteTable<span class="p">(</span>conn <span class="o">=</span> con<span class="p">,</span> name <span class="o">=</span> <span class="s">&#39;Test&#39;</span><span class="p">,</span> value <span class="o">=</span> as.data.frame<span class="p">(</span>Thurstone<span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<p>There! Now we have transferred our data.frame to our SQL database. Similarly, if
we want to read data <em>from</em> MySQL to R, we can use the <code>dbReadTable()</code> function,
which returns a data.frame.</p>

<p><img class="center" src="/images/rds3.png"></p>

<p>Last, you can keep your data in MySQL and stream it into R for specific analyses.
Since <code>dbReadTable</code> outputs a data.frame, we can use this command in place of a data.frame.</p>

<p>Let&#8217;s run an <code>omega()</code> on the Thurstone table:</p>

<figure class='code'><figcaption><span>Thurstone Omega</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'>omega<span class="p">(</span>dbReadTable<span class="p">(</span>conn <span class="o">=</span> con<span class="p">,</span>name <span class="o">=</span> <span class="s">&#39;Test&#39;</span><span class="p">),</span>title<span class="o">=</span><span class="s">&quot;9 variables from Thurstone&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>Thurstone Omega</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'>Loading required package<span class="o">:</span> MASS
</span><span class='line'>Loading required package<span class="o">:</span> GPArotation
</span><span class='line'>Loading required package<span class="o">:</span> parallel
</span><span class='line'><span class="m">9</span> variables from Thurstone
</span><span class='line'>Call<span class="o">:</span> omega<span class="p">(</span>m <span class="o">=</span> dbReadTable<span class="p">(</span>conn <span class="o">=</span> con<span class="p">,</span> name <span class="o">=</span> <span class="s">&quot;Test&quot;</span><span class="p">),</span> title <span class="o">=</span> <span class="s">&quot;9 variables from Thurstone&quot;</span><span class="p">)</span>
</span><span class='line'>Alpha<span class="o">:</span>                 <span class="m">0.89</span>
</span><span class='line'>G.6<span class="o">:</span>                   <span class="m">0.91</span>
</span><span class='line'>Omega Hierarchical<span class="o">:</span>    <span class="m">0.74</span>
</span><span class='line'>Omega H asymptotic<span class="o">:</span>    <span class="m">0.79</span>
</span><span class='line'>Omega Total            <span class="m">0.93</span>
</span><span class='line'>
</span><span class='line'>Schmid Leiman Factor loadings greater than  <span class="m">0.2</span>
</span><span class='line'>                   g   F1<span class="o">*</span>   F2<span class="o">*</span>   F3<span class="o">*</span>   h2   u2   p2
</span><span class='line'>Sentences       <span class="m">0.71</span>  <span class="m">0.57</span>             <span class="m">0.82</span> <span class="m">0.18</span> <span class="m">0.61</span>
</span><span class='line'>Vocabulary      <span class="m">0.73</span>  <span class="m">0.55</span>             <span class="m">0.84</span> <span class="m">0.16</span> <span class="m">0.63</span>
</span><span class='line'>Sent_Completion <span class="m">0.68</span>  <span class="m">0.52</span>             <span class="m">0.73</span> <span class="m">0.27</span> <span class="m">0.63</span>
</span><span class='line'>First_Letters   <span class="m">0.65</span>        <span class="m">0.56</span>       <span class="m">0.73</span> <span class="m">0.27</span> <span class="m">0.57</span>
</span><span class='line'>X4_Letter_Words <span class="m">0.62</span>        <span class="m">0.49</span>       <span class="m">0.63</span> <span class="m">0.37</span> <span class="m">0.61</span>
</span><span class='line'>Suffixes        <span class="m">0.56</span>        <span class="m">0.41</span>       <span class="m">0.50</span> <span class="m">0.50</span> <span class="m">0.63</span>
</span><span class='line'>Letter_Series   <span class="m">0.59</span>              <span class="m">0.61</span> <span class="m">0.72</span> <span class="m">0.28</span> <span class="m">0.48</span>
</span><span class='line'>Pedigrees       <span class="m">0.58</span>  <span class="m">0.23</span>        <span class="m">0.34</span> <span class="m">0.50</span> <span class="m">0.50</span> <span class="m">0.66</span>
</span><span class='line'>Letter_Group    <span class="m">0.54</span>              <span class="m">0.46</span> <span class="m">0.53</span> <span class="m">0.47</span> <span class="m">0.56</span>
</span><span class='line'>
</span><span class='line'>With eigenvalues of<span class="o">:</span>
</span><span class='line'>   g  F1<span class="o">*</span>  F2<span class="o">*</span>  F3<span class="o">*</span>
</span><span class='line'><span class="m">3.58</span> <span class="m">0.96</span> <span class="m">0.74</span> <span class="m">0.71</span>
</span><span class='line'>
</span><span class='line'>general<span class="o">/</span>max  <span class="m">3.71</span>   max<span class="o">/</span>min <span class="o">=</span>   <span class="m">1.35</span>
</span><span class='line'>mean percent general <span class="o">=</span>  <span class="m">0.6</span>    with sd <span class="o">=</span>  <span class="m">0.05</span> and cv of  <span class="m">0.09</span>
</span><span class='line'>Explained Common Variance of the general factor <span class="o">=</span>  <span class="m">0.6</span>
</span><span class='line'>
</span><span class='line'>The degrees of freedom are <span class="m">12</span>  and the fit is  <span class="m">0.01</span>
</span><span class='line'>
</span><span class='line'>The root mean square of the residuals is  <span class="m">0.01</span>
</span><span class='line'>The df corrected root mean square of the residuals is  <span class="m">0.01</span>
</span><span class='line'>
</span><span class='line'>Compare this with the adequacy of just a general factor and no group factors
</span><span class='line'>The degrees of freedom <span class="kr">for</span> just the general factor are <span class="m">27</span>  and the fit is  <span class="m">1.48</span>
</span><span class='line'>
</span><span class='line'>The root mean square of the residuals is  <span class="m">0.14</span>
</span><span class='line'>The df corrected root mean square of the residuals is  <span class="m">0.16</span>
</span><span class='line'>
</span><span class='line'>Measures of factor score adequacy
</span><span class='line'>                                                 g  F1<span class="o">*</span>  F2<span class="o">*</span>  F3<span class="o">*</span>
</span><span class='line'>Correlation of scores with factors            <span class="m">0.86</span> <span class="m">0.73</span> <span class="m">0.72</span> <span class="m">0.75</span>
</span><span class='line'>Multiple R square of scores with factors      <span class="m">0.74</span> <span class="m">0.54</span> <span class="m">0.52</span> <span class="m">0.56</span>
</span><span class='line'>Minimum correlation of factor score estimates <span class="m">0.49</span> <span class="m">0.08</span> <span class="m">0.03</span> <span class="m">0.11</span>
</span><span class='line'>
</span><span class='line'> Total<span class="p">,</span> General and Subset omega <span class="kr">for</span> each subset
</span><span class='line'>                                                 g  F1<span class="o">*</span>  F2<span class="o">*</span>  F3<span class="o">*</span>
</span><span class='line'>Omega total <span class="kr">for</span> total scores and subscales    <span class="m">0.93</span> <span class="m">0.92</span> <span class="m">0.83</span> <span class="m">0.79</span>
</span><span class='line'>Omega general <span class="kr">for</span> total scores and subscales  <span class="m">0.74</span> <span class="m">0.58</span> <span class="m">0.50</span> <span class="m">0.47</span>
</span><span class='line'>Omega group <span class="kr">for</span> total scores and subscales    <span class="m">0.16</span> <span class="m">0.35</span> <span class="m">0.32</span> <span class="m">0.32</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Useful Packages for Fast DB Operations</h2>

<p>Ideally, we want to have one set of analysis code that is somewhat agnostic to <em>how</em>
the data are stored.  I suggest looking into <a href="http://had.co.nz/">Hadley Wickham&#8217;s</a> new <a href="http://blog.rstudio.org/2014/01/17/introducing-dplyr/"><code>dplyr</code></a> package
(<a href="https://github.com/hadley/dplyr">Github</a>). <code>dplyr</code> is able to filter, sort, group, and summarize data
quickly whether it is stored in a data.frame, data.table, or database. Database operations may not always be as
fast as a data.table operation, but again, the advantage is that you don&#8217;t need to feed all of your data into memory.</p>

<p>Hadley provides a few vignettes for getting getting started with <code>dplyr</code>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'>vignette<span class="p">(</span><span class="s">&quot;introduction&quot;</span><span class="p">,</span> package <span class="o">=</span> <span class="s">&quot;dplyr&quot;</span><span class="p">)</span>
</span><span class='line'>vignette<span class="p">(</span><span class="s">&quot;databases&quot;</span><span class="p">,</span> package <span class="o">=</span> <span class="s">&quot;dplyr&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>

</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Jason A. French</span></span>

      








  


<time datetime="2014-07-03T10:58:00-07:00" pubdate data-updated="true">Jul 3<span>rd</span>, 2014</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/amazon-rds/'>Amazon RDS</a>, <a class='category' href='/blog/categories/mysql/'>MySQL</a>, <a class='category' href='/blog/categories/r/'>R</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://frenchja.github.com/blog/2014/07/03/using-r-with-mysql-databases/" data-via="" data-counturl="http://frenchja.github.com/blog/2014/07/03/using-r-with-mysql-databases/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2014/04/25/formatting-sweave-and-knitr-output-for-2-digits/" title="Previous Post: Fixing knitr: Formatting statistical output to 2 digits in R">&laquo; Fixing knitr: Formatting statistical output to 2 digits in R</a>
      
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/07/03/using-r-with-mysql-databases/">Using R with MySQL Databases</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/04/25/formatting-sweave-and-knitr-output-for-2-digits/">Fixing knitr: Formatting statistical output to 2 digits in R</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/11/07/faster-tetrachoric-correlations/">Faster Tetrachoric Correlations</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/10/25/analyzing-student-exams-using-irt/">Analyze Student Exam Items using IRT</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/08/16/easy-sweaving-for-latex-and-r/">Easy Sweave for LaTeX and R</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/frenchja">@frenchja</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'frenchja',
            count: 4,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>



<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/113717313588371204162?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>


<section>
  <h1>Popular Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2012/01/17/using-figures-within-tables-in-latex/">Using Figures within Tables in LaTeX</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/03/07/graphing-error-bars-for-repeated-measures-variables-with-ggplot2/">Graphing Error Bars for Repeated-Measures Variables with ggplot2</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/03/27/integrating-r-and-qualtrics/">Analyzing Qualtrics Data in R using Github Packages</a>
      </li>
    
  </ul>
</section>

  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Jason A. French -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>
</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'frenchja';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://frenchja.github.com/blog/2014/07/03/using-r-with-mysql-databases/';
        var disqus_url = 'http://frenchja.github.com/blog/2014/07/03/using-r-with-mysql-databases/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
