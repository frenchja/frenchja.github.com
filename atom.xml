<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Jason A. French]]></title>
  <link href="http://frenchja.github.com/atom.xml" rel="self"/>
  <link href="http://frenchja.github.com/"/>
  <updated>2014-02-07T13:26:18-06:00</updated>
  <id>http://frenchja.github.com/</id>
  <author>
    <name><![CDATA[Jason A. French]]></name>
    <email><![CDATA[frenchja@gmail.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Faster Tetrachoric Correlations]]></title>
    <link href="http://frenchja.github.com/blog/2013/11/07/faster-tetrachoric-correlations/"/>
    <updated>2013-11-07T16:48:00-06:00</updated>
    <id>http://frenchja.github.com/blog/2013/11/07/faster-tetrachoric-correlations</id>
    <content type="html"><![CDATA[<h2>What are tetra- and polychoric correlations?</h2>

<p>Polychoric correlations estimate the correlation between two theorized normal distributions given two ordinal variables.  In psychological research, much of our data fits this definition.  For example, many survey studies used with introductory psychology pools use Likert scale items.  The responses to these items typically range from 1 (Strongly disagree) to 6 (Strongly agree).  However, we don&#8217;t <em>really</em> think that person&#8217;s relationship to the item is actually polytomous.  Instead, it&#8217;s an imperfect approximation.</p>

<p>Similarly, tetrachorics are special cases of polychoric crrelations when the variable of interest is dichotomous. The participant may have gotten the item either correct (i.e., 1) or incorrect (i.e., 0), but the underlying knowledge that led to the items&#8217; response is probably a continuous distribution.</p>

<p>When you have polytomous rating scales but want to disattenuate the correlations to more accurately estimate the correlation betwen the latent continuous variables, one way of doing this is to use a tetrachoric or polychoric correlation coefficient.</p>

<h2>The problem</h2>

<p>At the <a href="https://sapa-project.org">SAPA Project</a>, the majority of our data is polytomous.  We ask you the degree to which you like to go to lively parties to estimate your score on latent <em>extraversion</em>.  Presently, we use <code>mixed.cor()</code>, which calls a combination of the <code>tetrachoric()</code> and <code>polychoric()</code> functions in the <code>psych</code> package (Revelle, W., 2013).</p>

<p>However, each time we build a new dataset from the website&#8217;s SQL server, it takes <em>hours</em>.  And that&#8217;s <strong>if</strong> everything goes correctly.  If there&#8217;s an error in the code or a bug in a new function, it may take hours to hit the error, wasting your day.</p>

<p>After a bit of profiling, it was revealed that much of our time building the SAPA dataset was used estimating the tetrachoric and polychoric correlation coefficients.  When you do this for 250,000+ participants for 10,000+ variables, it takes <em>a long time</em>.  So Bill and I thought about how we could speed them up and feel others may benefit from our optimization.</p>

<!-- more -->


<h3>Optimizing the existing function for a 300% speed up</h3>

<p>If we call <code>psych:::tetraBinBvn</code>, we see that most of the time spent computer the tetrachorics is using <code>pmvnorm</code> to estimate each of the 4 probabilities of the tetrachoric:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'>psych<span class="o">:::</span>tetraBinBvn
</span><span class='line'><span class="kr">function</span> <span class="p">(</span>rho<span class="p">,</span> rc<span class="p">,</span> cc<span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    row.cuts <span class="o">&lt;-</span> c<span class="p">(</span><span class="o">-</span><span class="kc">Inf</span><span class="p">,</span> rc<span class="p">,</span> <span class="kc">Inf</span><span class="p">)</span>
</span><span class='line'>    col.cuts <span class="o">&lt;-</span> c<span class="p">(</span><span class="o">-</span><span class="kc">Inf</span><span class="p">,</span> cc<span class="p">,</span> <span class="kc">Inf</span><span class="p">)</span>
</span><span class='line'>    P <span class="o">&lt;-</span> matrix<span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">2</span><span class="p">)</span>
</span><span class='line'>    R <span class="o">&lt;-</span> matrix<span class="p">(</span>c<span class="p">(</span><span class="m">1</span><span class="p">,</span> rho<span class="p">,</span> rho<span class="p">,</span> <span class="m">1</span><span class="p">),</span> <span class="m">2</span><span class="p">,</span> <span class="m">2</span><span class="p">)</span>
</span><span class='line'>    <span class="kr">for</span> <span class="p">(</span>i <span class="kr">in</span> <span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="kr">for</span> <span class="p">(</span>j <span class="kr">in</span> <span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            P<span class="p">[</span>i<span class="p">,</span> j<span class="p">]</span> <span class="o">&lt;-</span> pmvnorm<span class="p">(</span>lower <span class="o">=</span> c<span class="p">(</span>row.cuts<span class="p">[</span>i<span class="p">],</span> col.cuts<span class="p">[</span>j<span class="p">]),</span>
</span><span class='line'>                upper <span class="o">=</span> c<span class="p">(</span>row.cuts<span class="p">[</span>i <span class="o">+</span> <span class="m">1</span><span class="p">],</span> col.cuts<span class="p">[</span>j <span class="o">+</span> <span class="m">1</span><span class="p">]),</span>
</span><span class='line'>                corr <span class="o">=</span> R<span class="p">)</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    P
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="o">&lt;</span>environment<span class="o">:</span> namespace<span class="o">:</span>psych<span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="http://gradstudents.wcas.northwestern.edu/~jaf502/images/tetra.png"></p>

<p>The function says for each row <em>i</em> and each column <em>j</em>, optimize a probability based on the lower and upper bounds of the row cuts and column cuts.  <strong>But wait!</strong>  Since the sum of the probabilities in the tetrachoric 2x2 matrix add to 1, why not just use a bit of subtraction to figure it out?  That would avoid waiting on <code>pvnorm</code> to compute each cell.</p>

<p>This solution resulted in a speed up of <code>tetrachor()</code> by a factor of 3!  See our benchmarks below!</p>

<p>Unfortunately, our trick doesn&#8217;t work for the <code>polychor()</code> function as well, since there are more degrees of freedom. However, we can eliminate calling <code>pvnorm()</code> for 11 cells in a hypothetical 6x6 matrix as we only need to find the values for 25 and can use subtraction to speed up the estimation of the remaining 11.  This results in a less impressive speed up for <code>polychor()</code> that I nonetheless hope will benefit researchers.</p>

<h2>Testing our result</h2>

<h3>Generate our hypothetical dataset</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'>library<span class="p">(</span>psych<span class="p">)</span>
</span><span class='line'>data <span class="o">&lt;-</span> sim.irt<span class="p">(</span>nvar <span class="o">=</span> <span class="m">50</span><span class="p">,</span> n <span class="o">=</span> <span class="m">500</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Profiling old code</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'>system.time<span class="p">(</span>old <span class="o">&lt;-</span> polychoric<span class="p">(</span>data<span class="o">$</span>items<span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'><span class="c1">##    user  system elapsed </span>
</span><span class='line'><span class="c1">##  16.733   0.097  17.286</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Profiling new code</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'>system.time<span class="p">(</span>new <span class="o">&lt;-</span> polychoric<span class="p">(</span>data<span class="o">$</span>items<span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'><span class="c1">##    user  system elapsed </span>
</span><span class='line'><span class="c1">##   6.336   0.035   6.537</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Differences between new and old results</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'>round<span class="p">(</span>new<span class="o">$</span>rho <span class="o">-</span> old<span class="o">$</span>rho<span class="p">,</span> <span class="m">2</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'><span class="c1">##       V1 V2    V3 V4 V5 V6 V7   V8 V9 V10 V11 V12 V13 V14 V15 V16 V17 V18</span>
</span><span class='line'><span class="c1">## V1  0.00  0  0.00  0  0  0  0 0.00  0   0   0   0   0   0   0   0   0   0</span>
</span><span class='line'><span class="c1">## V2  0.00  0  0.00  0  0  0  0 0.00  0   0   0   0   0   0   0   0   0   0</span>
</span><span class='line'><span class="c1">## V3  0.00  0  0.00  0  0  0  0 0.00  0   0   0   0   0   0   0   0   0   0</span>
</span><span class='line'><span class="c1">## V4  0.00  0  0.00  0  0  0  0 0.00  0   0   0   0   0   0   0   0   0   0</span>
</span><span class='line'><span class="c1">## V5  0.00  0  0.00  0  0  0  0 0.00  0   0   0   0   0   0   0   0   0   0</span>
</span><span class='line'><span class="c1">## V6  0.00  0  0.00  0  0  0  0 0.00  0   0   0   0   0   0   0   0   0   0</span>
</span><span class='line'><span class="c1">## V7  0.00  0  0.00  0  0  0  0 0.00  0   0   0   0   0   0   0   0   0   0</span>
</span><span class='line'><span class="c1">## V8  0.00  0  0.00  0  0  0  0 0.00  0   0   0   0   0   0   0   0   0   0</span>
</span><span class='line'><span class="c1">## V9  0.00  0  0.00  0  0  0  0 0.00  0   0   0   0   0   0   0   0   0   0</span>
</span><span class='line'><span class="c1">## V10 0.00  0  0.00  0  0  0  0 0.00  0   0   0   0   0   0   0   0   0   0</span>
</span><span class='line'><span class="kc">...</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Analyze Student Exam Items using IRT]]></title>
    <link href="http://frenchja.github.com/blog/2013/10/25/analyzing-student-exams-using-irt/"/>
    <updated>2013-10-25T14:26:00-05:00</updated>
    <id>http://frenchja.github.com/blog/2013/10/25/analyzing-student-exams-using-irt</id>
    <content type="html"><![CDATA[<p>I&#8217;ve cross-posted this at the <a href="http://sapa-project.org/blog/">SAPA Project&#8217;s blog</a>.</p>

<p><a href="https://en.wikipedia.org/wiki/Item_response_theory">Item Response Theory</a> can be used to evaluate the effectiveness of
exams given to students.  One distinguishing feature from other paradigms is that it does not assume that every question
is equally difficult (or that the difficulty is tied to what the researcher said).  In this way, it is an empirical investigation
into the effectiveness of a given exam and can help the researcher 1) eliminate bad or problematic items and 2) judge whether the test was too difficult or the students simply didn&#8217;t study.</p>

<p>In the following tutorial, we&#8217;ll use <a href="http://www.r-project.org/">R</a> (R Core Team, 2013) along with the <a href="http://cran.r-project.org/web/packages/psych/index.html"><code>psych</code></a> package (Revelle, W., 2013) to look at a hypothetical exam.</p>

<!-- more -->


<p>Before we get started, remember that <code>R</code> is a programming language.  In the examples below, I perform operations on data using <a href="https://en.wikipedia.org/wiki/Function_%28computer_science%29"><em>functions</em></a> like <a href="http://stat.ethz.ch/R-manual/R-patched/library/stats/html/cor.html"><code>cor</code></a> and <a href="http://stat.ethz.ch/R-manual/R-devel/library/utils/html/read.table.html"><code>read.csv</code></a>.  We can also save the output as <a href="https://en.wikipedia.org/wiki/Object_%28computer_science%29"><em>objects</em></a> using the assignment arrow, <code>&lt;-</code>. It&#8217;s a bit different from a point-and-click program like SPSS, but you <em>don&#8217;t</em> need to know how to program to analyze exams and questions using IRT!</p>

<p>First, load the the <code>psych</code> package.  Next, load the students&#8217; grades into R using <code>read.csv()</code> from the <code>psych</code> package.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'><span class="c1"># Load the psych package</span>
</span><span class='line'>library<span class="p">(</span>psych<span class="p">)</span>
</span><span class='line'><span class="c1"># Read the csv file and save it as grades</span>
</span><span class='line'>grades <span class="o">&lt;-</span> read.csv<span class="p">(</span>file <span class="o">=</span> <span class="s">&quot;~/Downloads/Grades.csv&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Notice that we are using item-level grades, where each row is a given student and each cell is the number of points received on that question.  In my example, V1, V2, etc. correspond to exam questions.  Your matrix or data frame should look like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'>head<span class="p">(</span>grades<span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'><span class="c1">##   V1 V2 V3 V4 V5 V6 V7 V8 V9 V10 V11 V12 V13 V14 V15 V16 V17 V18 V19 V20</span>
</span><span class='line'><span class="c1">## 1  2  2  2  2  4  2  3  2  4   2   2   3   5   3   6   2   4   4   4   3</span>
</span><span class='line'><span class="c1">## 2  2  0  2  2  0  0  3  0  4   2   0   1   3   0   0   2   2   1   0   0</span>
</span><span class='line'><span class="c1">## 3  2  2  2  2  0  2  3  2  4   0   0   3   5   0   5   2   4   2   4   2</span>
</span><span class='line'><span class="c1">## 4  2  1  2  2  3  0  0  2  4   2   2   3   1   1   2   0   4   1   4   3</span>
</span><span class='line'><span class="c1">## 5  2  2  2  2  4  2  3  2  4   2   2   3   5   3   4   2   4   4   4   3</span>
</span><span class='line'><span class="c1">## 6  1  0  2  2  0  2  0  2  0   2   1   2   5   0   3   2   4   2   4   3</span>
</span><span class='line'><span class="c1">##   V21 V22 V23 V24 V25 V26 V27 Total</span>
</span><span class='line'><span class="c1">## 1   2   2   4   4   6   6   6    91</span>
</span><span class='line'><span class="c1">## 2   0   0   0   3   3   6   6    42</span>
</span><span class='line'><span class="c1">## 3   2   1   2   4   6   5   6    72</span>
</span><span class='line'><span class="c1">## 4   0   2   4   4   0   0   0    49</span>
</span><span class='line'><span class="c1">## 5   2   2   4   4   5   6   6    88</span>
</span><span class='line'><span class="c1">## 6   0   0   4   4   6   4   3    58</span>
</span></code></pre></td></tr></table></div></figure>


<p>Next, compute the <a href="https://en.wikipedia.org/wiki/Polychoric_correlation">polychoric correlations</a> on the raw grades (not including the Total column).  By using polychoric correlations, we estimate the normal distribution of latent content knowledge, which can be underestimated if Pearson correlations are instead used on polytomous items (see  Lee, Poon &amp; Bentler, 1995).</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'><span class="c1"># Perform a polychoric correlation on grades and save it as grades.poly</span>
</span><span class='line'>grades.poly <span class="o">&lt;-</span> polychoric<span class="p">(</span>x <span class="o">=</span> grades<span class="p">[,</span> <span class="m">1</span><span class="o">:</span><span class="m">27</span><span class="p">],</span> polycor <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now that we have the polychoric correlations, we can run <code>irt.fa()</code> on the dataset to see the item difficulties and information.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'><span class="c1"># Using grades.poly, perform an irt and save it as grades.irt</span>
</span><span class='line'>grades.irt <span class="o">&lt;-</span> irt.fa<span class="p">(</span>x <span class="o">=</span> grades.poly<span class="p">,</span> plot <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span><span class='line'><span class="c1"># Plot the output from grades.irt</span>
</span><span class='line'>plot<span class="p">(</span>grades.irt<span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="http://gradstudents.wcas.northwestern.edu/~jaf502/images/grades.png"></p>

<p>Thus, we have some great items that have a lot of information about students of average and low content knowledge (e.g., V24, V17, V18), but not enough to distinguish the high-knowledge students.  In redesigning an exam for next semester or year, we might save the best performing questions while trying to rewrite the existing questions or trying new questions.</p>

<p>Next, let&#8217;s see what how well the test did <em>overall</em> at distinguishing students:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'>plot.irt<span class="p">(</span>type <span class="o">=</span> <span class="s">&quot;test&quot;</span><span class="p">,</span> grades.irt<span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="http://gradstudents.wcas.northwestern.edu/~jaf502/images/test.png"></p>

<p>The second plot shows the <em>test performance</em>.  We have great reliability for distinguishing who didn&#8217;t study (lowers end of our latent trait), but overall the test may have been too easy (opposite of my prediction).  It&#8217;s important that the test is not too difficult to discourage students, but the graph above suggests that we had very low information at how students that studied were different from eachother.  This is again reflected by the histogram plotted in the next section, where high scoring students seem to cluster together.</p>

<h2>Rescaling the test</h2>

<p>While many students in our hypothetical dataset did very well on the exam, instructors may
need to rescale their exam so that the mean grade is an 85% or 87.5%.  Using the <code>scale()</code> function (see also <a href="http://personality-project.org/r/psych/help/rescale.html"><code>rescale()</code></a> in <code>psych</code> package), we
can ensure that the <a href="https://en.wikipedia.org/wiki/Ranking#Ranking_in_statistics?s">rank-order</a> distribution of the students is preserved (allowing us to distinguish
those who studied well from those who didn&#8217;t), while scaling the sample distribution to fit in with other classes in your department.</p>

<p>Currently, our scores are in cumulative raw points.  Notice that we divide the Total points column by 91 to convert the histogram into grade percentages.  Let&#8217;s plot a histogram to see the distribution of scores.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'><span class="c1"># Load the ggplot2 library</span>
</span><span class='line'>library<span class="p">(</span>ggplot2<span class="p">)</span>
</span><span class='line'><span class="c1"># Plot a histogram</span>
</span><span class='line'>qplot<span class="p">((</span>Total<span class="o">/</span><span class="m">91</span><span class="p">)</span><span class="o">*</span><span class="m">100</span><span class="p">,</span> data<span class="o">=</span>grades<span class="p">,</span> geom<span class="o">=</span><span class="s">&quot;histogram&quot;</span><span class="p">,</span>xlab<span class="o">=</span><span class="s">&#39;Raw Grades&#39;</span><span class="p">,</span>
</span><span class='line'>  ylab<span class="o">=</span><span class="s">&#39;# of Students&#39;</span><span class="p">,</span>main<span class="o">=</span><span class="s">&#39;Distribution of student grades&#39;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="http://gradstudents.wcas.northwestern.edu/~jaf502/images/raw.png"></p>

<p>The distribution has a mean 71.68 percent and a standard deviation of 15.54.  Given grade inflation,
it may look like your students are doing poorly when in fact the distribution is similiar to other courses
being taught.  Next, we can rescale the grades, creating a mean of 87.5 and a standard deviation of 7.5.  These numbers are arbitrary so use your best judgement.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'>scaled.grades <span class="o">&lt;-</span> scale<span class="p">(</span>grades<span class="o">$</span>Total<span class="p">)</span> <span class="o">*</span> <span class="m">7.5</span> <span class="o">+</span> <span class="m">87.5</span>
</span><span class='line'>qplot<span class="p">(</span>scaled.grades<span class="p">,</span>xlab<span class="o">=</span><span class="s">&#39;Scaled Grades&#39;</span><span class="p">,</span>
</span><span class='line'>  ylab<span class="o">=</span><span class="s">&#39;# of Students&#39;</span><span class="p">,</span>main<span class="o">=</span><span class="s">&#39;Distribution of student grades&#39;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="http://gradstudents.wcas.northwestern.edu/~jaf502/images/scaled.png"></p>

<p>The second distribution may be preferred, depending on your needs.  With the raw distribution, we would have had 45% of the students receiving grades below a C-, assuming a normal distribution (for the curious, R can calculate these probabilites using the <code>pnorm</code> function: <code>pnorm(q=70,mean=71.68,sd=15.54)</code>).  Now, 0.9% of students would fall below the 70% cutoff.  Again, my mean and standard deviation chosen in the above example are arbitrary.</p>

<h2>References</h2>

<ul>
<li><p>Lee, S. Y., Poon, W. Y., &amp; Bentler, P. M. (1995). <em>A two‐stage estimation of structural equation models with continuous and polytomous variables</em>. British Journal of Mathematical and Statistical Psychology, 48(2), 339-358.</p></li>
<li><p>R Core Team (2013). <em>R: A language and environment for statistical computing</em>. R Foundation for Statistical Computing, Vienna, Austria. <a href="http://www.R-project.org/">http://www.R-project.org/</a>.</p></li>
<li><p>Revelle, W. (2013). <em>psych: Procedures for Personality and Psychological Research</em>. Northwestern University, Evanston, Illinois, USA. <a href="http://CRAN.R-project.org/package=psych">http://CRAN.R-project.org/package=psych</a>. Version = 1.3.10.</p></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Easy Sweave for LaTeX and R]]></title>
    <link href="http://frenchja.github.com/blog/2013/08/16/easy-sweaving-for-latex-and-r/"/>
    <updated>2013-08-16T12:41:00-05:00</updated>
    <id>http://frenchja.github.com/blog/2013/08/16/easy-sweaving-for-latex-and-r</id>
    <content type="html"><![CDATA[<p>When you&#8217;re writing up reports using statistics from R, it can be tiresome
to constantly copy and paste results from the R Console.  To get around this, many of us use Sweave, which allows us to <em>embed</em> R code in LaTeX files.
<a href="https://en.wikipedia.org/wiki/Sweave">Sweave</a> is an R function that converts R code to LaTeX, a document typesetting language.  This enables accurate, shareable analyses as well as high-resolution graphs that are publication quality.</p>

<p>Needless to say, the marriage of statistics with documents makes writing up APA-style reports a bit easier, especially with Brian Beitzel&#8217;s amazing <a href="http://www.ctan.org/pkg/apa6"><code>apa6</code> class for LaTeX</a>.</p>

<!-- more -->


<h2>Making Sweave Available Systemwide</h2>

<p>However, Sweave doesn&#8217;t always work correctly.  One common complaint that you&#8217;ll get after Sweaving a file is <code>Sweave.sty not found!</code>. While Sweave.sty is a LaTeX package, it doesn&#8217;t <em>live</em> with the rest of the LaTeX packages because it&#8217;s installed using R.  Many people try to solve this by copying and pasting Sweave.sty into every document directory, but I&#8217;m sharing a better way below.</p>

<p>Using <a href="https://en.wikipedia.org/wiki/Terminal_%28OS_X%29">Terminal.app</a>:</p>

<figure class='code'><figcaption><span>Go to the MacTeX or TeX Live local directory.</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nb">cd</span> /usr/local/texlive/texmf-local/tex/latex
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>Form a link between the R Sweave.sty files and MacTeX</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo ln -s /Library/Frameworks/R.framework/Resources/share/texmf/ Sweave
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>Tell MacTeX/TeX Live to recognize the file and rebuild the database</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo mktexlsr
</span></code></pre></td></tr></table></div></figure>


<p>If using <code>mktexlsr</code> results in a <code>command not found</code> error, the TeX Live distribution probably isn&#8217;t in your <a href="https://en.wikipedia.org/wiki/PATH_%28variable%29">$PATH</a>, but you can hunt for the program anyway.  For example, if you&#8217;re using MacTeX 2013, the program will be found in a directory similar to this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo /usr/local/texlive/2013/bin/x86_64-darwin/mktexlsr
</span></code></pre></td></tr></table></div></figure>


<h2>Using Sweave in TeXShop</h2>

<p>When you&#8217;re getting started with LaTeX, many Mac users prefer the bundled
editor, TeXShop.  <a href="http://cameron.bracken.bz/sweave-for-texshop">Cameron Bracken</a> gives us a helpful piece of code that allows easy Sweaving straight from TeXShop.  TeXShop uses various <em>engines</em> that allow it to render LaTeX.  Using a bit of <a href="https://en.wikipedia.org/wiki/Bash_%28Unix_shell%29"><code>BASH</code></a> scripting, we can write our own Sweave engine and make it available right within TeXShop.  I have adapted Cameron&#8217;s original engine to accomodate Bibtex citations (<a href="https://en.wikibooks.org/wiki/LaTeX/Bibliography_Management#Why_won.27t_LaTeX_generate_any_output.3F">see here</a>).</p>

<p>Using a text editor, paste in the following syntax and save the file as Sweave.engine:</p>

<figure class='code'><figcaption><span>Sweave.engine</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c">#!/bin/env bash</span>
</span><span class='line'><span class="nb">export </span><span class="nv">PATH</span><span class="o">=</span><span class="nv">$PATH</span>:/usr/texbin:/usr/local/bin
</span><span class='line'>R CMD Sweave <span class="s2">&quot;$1&quot;</span>
</span><span class='line'>pdflatex <span class="s2">&quot;${1%.*}&quot;</span>
</span><span class='line'>bibtex <span class="s2">&quot;${1%.aux}&quot;</span>
</span><span class='line'>pdflatex <span class="s2">&quot;${1%.*}&quot;</span>
</span><span class='line'><span class="c"># If you run pdflatex again you get citations</span>
</span><span class='line'>pdflatex <span class="s2">&quot;${1%.*}&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Next, in Terminal.app, move the file to the TeXShop engines folder:</p>

<figure class='code'><figcaption><span>Enable the Sweave.engine</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>mv Sweave.engine ~/Library/TeXShop/Engines/
</span><span class='line'>chmod +x ~/Library/TeXShop/Engines/Sweave.engine
</span></code></pre></td></tr></table></div></figure>


<p><img src="http://gradstudents.wcas.northwestern.edu/~jaf502/images/sweaveengine.png"></p>

<p>Now restart TeXShop if it&#8217;s running and you should see Sweave as an available option!</p>

<p><img src="http://gradstudents.wcas.northwestern.edu/~jaf502/images/sweave.png"></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Installing R in Linux]]></title>
    <link href="http://frenchja.github.com/blog/2013/03/11/installing-r-in-linux/"/>
    <updated>2013-03-11T17:18:00-05:00</updated>
    <id>http://frenchja.github.com/blog/2013/03/11/installing-r-in-linux</id>
    <content type="html"><![CDATA[<p>This guide is intended to faciliate the installation of up-to-date R packages
for users new to either R or Linux.  Unlike Windows binaries or Mac packages,
Linux software is often distributed as source-code and then compiled by package
maintainers.  The use of package managers has many advantages that I won&#8217;t
discuss here (see <a href="https://en.wikipedia.org/wiki/Package_management_system">Wikipedia</a>).<br/>
More importantly, the difference can be initially intimidating.<br/>
However, once the user gets used to using package managers such as
<a href="https://en.wikipedia.org/wiki/Advanced_Packaging_Tool">apt</a> or
<a href="https://en.wikipedia.org/wiki/Yellowdog_Updater,_Modified">yum</a> to install software,
I&#8217;m confident they&#8217;ll appreciate their ease of use.</p>

<p>These instructions are organized by system type.</p>

<h2>Debian-based Distributions</h2>

<h3>Ubuntu</h3>

<p>Full installation instructions for Ubuntu can be found
<a href="http://cran.rstudio.com/bin/linux/ubuntu/">here</a>.  Luckily, CRAN mirrors have
compiled binaries of R which can be installed using the apt-get package manager.
To accomplish this, we&#8217;ll first add the <a href="http://cran.us.r-project.org/bin/linux/ubuntu/">CRAN
repo</a> for Ubuntu packages to
<code>/etc/apt/sources.list</code>.  If you prefer to manually edit the sources.list file,
you can do so by issuing the following in the terminal:</p>

<figure class='code'><figcaption><span>Inspecting sources.list</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo nano /etc/apt/sources.list
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>Installing R in Ubuntu</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c"># Grabs your version of Ubuntu as a BASH variable</span>
</span><span class='line'><span class="nv">CODENAME</span><span class="o">=</span><span class="sb">`</span>grep CODENAME /etc/lsb-release | cut -c 18-<span class="sb">`</span>
</span><span class='line'>
</span><span class='line'><span class="c"># Appends the CRAN repository to your sources.list file </span>
</span><span class='line'>sudo sh -c <span class="s1">&#39;echo &quot;deb http://cran.rstudio.com/bin/linux/ubuntu $CODENAME&quot; &gt;&gt; /etc/apt/sources.list&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="c"># Adds the CRAN GPG key, which is used to sign the R packages for security.</span>
</span><span class='line'>sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys E084DAB9
</span><span class='line'>
</span><span class='line'>sudo apt-get update
</span><span class='line'>sudo apt-get install r-base r-dev
</span></code></pre></td></tr></table></div></figure>




<!-- more -->


<h3>Debian</h3>

<p>The instructions for installing R in Debian are similar to Ubuntu.  Regarding &#8216;stable&#8217;
versions of Debian, the CRAN
<a href="http://cran.rstudio.com/bin/linux/debian/README.html">README file</a> for Debian
points out:</p>

<blockquote><p>After a release of Debian &#8220;stable&#8221;, no new packages get added by<br/>Debian to keep the release as &#8216;stable&#8217; as possible. This implies that the R<br/>release contained in the official Debian release will become outdated as time<br/>passes.</p><footer><strong>CRAN</strong> <cite><a href='http://cran.us.r-project.org/bin/linux/debian/README.html'>README</a></cite></footer></blockquote>


<p>Thus, we&#8217;ll append the CRAN repository to the Debian list to update the available R version, just like
we did for Ubuntu:</p>

<figure class='code'><figcaption><span>Installing R in Debian Stable</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c"># Appends the CRAN repository to your sources.list file </span>
</span><span class='line'>sudo sh -c <span class="s1">&#39;echo &quot;deb http://cran.rstudio.com/bin/linux/debian lenny-cran/&quot; &gt;&gt; /etc/apt/sources.list&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="c"># Adds the CRAN GPG key, which is used to sign the R packages for security.</span>
</span><span class='line'>sudo apt-key adv --keyserver subkeys.pgp.net --recv-key 381BA480
</span><span class='line'>sudo apt-get update
</span><span class='line'>sudo apt-get install r-base r-base-dev
</span></code></pre></td></tr></table></div></figure>


<p>Finally, you can search for additional R packages in terminal using <code>apt-cache</code>:</p>

<figure class='code'><figcaption><span>Searching for R packages using apt-get</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>apt-cache search ^r-.*
</span></code></pre></td></tr></table></div></figure>


<h3>Installing RStudio</h3>

<p>Rstudio is a cross-platform user interface for R. The
RStudio package is compiled for both Debian and Ubuntu distributions.
Therefore, the installation instructions are the same.  Copy the link for the
latest RStudio package from <a href="http:/%0A/www.rstudio.com/ide/download/desktop">http://www.rstudio.com/ide/download/desktop</a> (e.g., <a href="http://download1.rstudio.org/rstudio-0.97.320-amd64.deb">http://download1.rstudio.org/rstudio-0.97.320-amd64.deb</a>
).</p>

<figure class='code'><figcaption><span>Installing RStudio using apt-get</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo apt-get install http://download1.rstudio.org/rstudio-0.97.320-amd64.deb
</span></code></pre></td></tr></table></div></figure>


<h2>RedHat-based Distributions</h2>

<h3>RedHat EL6 (or CentOS 6+)</h3>

<p>In order to get R running on RHEL 6, we&#8217;ll need to add an additional repository
that allows us to install the new packages, EPEL.  <a href="https://fedoraproject.org/wiki/EPEL">Extra Packages for
Enterprise Linux</a> (or EPEL) is a Fedora
Special Interest Group that creates, maintains, and manages a high quality set
of additional packages for Enterprise Linux, including, but not limited to, Red
Hat Enterprise Linux (RHEL), CentOS and Scientific Linux (SL).</p>

<figure class='code'><figcaption><span>Installing EPEL and R</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c"># For El5 or CentOS 5</span>
</span><span class='line'>su -c <span class="s1">&#39;rpm -Uvh http://download.fedoraproject.org/pub/epel/5/i386/epel-release-5-4.noarch.rpm&#39;</span>
</span><span class='line'>sudo yum update
</span><span class='line'>sudo yum install R
</span><span class='line'>
</span><span class='line'><span class="c"># For El6 or CentOS 6</span>
</span><span class='line'>su -c <span class="s1">&#39;rpm -Uvh http://download.fedoraproject.org/pub/epel/6/i386/epel-release-6-8.noarch.rpm&#39;</span>
</span><span class='line'>sudo yum update
</span><span class='line'>sudo yum install R
</span></code></pre></td></tr></table></div></figure>


<p>Finally, you can search for additional R packages in terminal using <code>yum</code>:</p>

<figure class='code'><figcaption><span>Searching for R packages using yum</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>yum list R-<span class="se">\*</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Fedora</h3>

<p>For Fedora, life is much easier.  Current versions of Fedora have an up-to-date build of R in their repositories.</p>

<figure class='code'><figcaption><span>Installing R in Fedora</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo yum update
</span><span class='line'>sudo yum install R
</span></code></pre></td></tr></table></div></figure>


<h3>Installing RStudio</h3>

<p>You&#8217;ll want to copy the appropriate link for your system from the <a href="http://www.rstudio.com/ide/download/desktop">RStudio Desktop Download</a> page.  In my case, it was <code>http://download1.rstudio.org/rstudio-0.97.320-x86_64.rpm</code>.</p>

<figure class='code'><figcaption><span>Installing RStudio on Fedora/RHEL/CentOS</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo yum install http://download1.rstudio.org/rstudio-0.97.320-x86_64.rpm
</span></code></pre></td></tr></table></div></figure>


<h1>Dealing with PPC-based Systems</h1>

<p>As our lab has a lot of old iMacs that are still quite useful, I&#8217;ve recently
dealt with the best way to support R on these machines.  These machines are
still quite useful, particulary when their maximum potential RAM is installed.
However, Apple stopped supporting the machines after OS 10.5.8 (<a href="https://en.wikipedia.org/wiki/Apple%27s_transition_to_Intel_processors">see here</a>).
While the <a href="http://r.research.att.com/">nightly packages</a> distributed do install
on PPC machines with OS X, they lack the R Framework compiled for PPC, meaning
that it&#8217;s a useless installation.  This means that a user stuck on OS X 10.5.8
is tied to R 2.10, a very old R distribution that&#8217;s incompatible with many
existing packages.</p>

<h2>Any solutions?</h2>

<p>My first solution was to compile R from source using
<a href="https://www.macports.org/">MacPorts</a>, a package manager similar in concept to
<code>yum</code> or <code>apt-get</code>.  While successful, it takes a <em>long</em>, <em>long</em>, time to build
R and its necessary dependencies on a 1.8 Ghz G5 processor.  From a system
administrator&#8217;s perspective, this also is the least parsimonious solution
possible, since each machine has to be updated with each new release of R.</p>

<p>Thanks to <a href="http://www.rstudio.com/ide/docs/server/getting_started">RStudio Server</a>, each machine
doesn&#8217;t need to have R installed, as it can be run off a more powerful server
and accessed using a reasonably up-to-date browser.  I was able to install R and
RStudio on our RedHat EL6 server easily.  The trick was to make this as seemless
as possible from the user&#8217;s perspective.  To accomplish this, I saved the
Bookmark to the Desktop.</p>

<p><img class="right" src="http://gradstudents.wcas.northwestern.edu/~jaf502/images/ppc-r-bookmark.png" title="R Bookmark" ></p>

<p>Next, I downloaded a large R icon using Google Images and edited the Bookmark&#8217;s
icon to appear as if it were R.  To do this, just copy the R icon from within
Preview, select the icon of the Bookmark by right-clicking and selecting Get
Info, and pasting using <code>Command+V</code>.</p>

<p><img class="left" src="http://gradstudents.wcas.northwestern.edu/~jaf502/images/ppc-r-preview.png" width="300" title="R Preview" ></p>

<p><img class="left" src="http://gradstudents.wcas.northwestern.edu/~jaf502/images/ppc-r-getinfo.png" title="Get Info" ></p>

<p>Finally, this was dragged to the OS X dock, appearing just as if it were R on the local machine, but without all the hassle and slow load times on PPC.</p>

<p><img src="http://gradstudents.wcas.northwestern.edu/~jaf502/images/ppc-r-dock.png" title="Fake Dock Icon" ></p>

<p>It is worth noting that this solution is only important for users tied to OS X
10.5.8.  I&#8217;ve had great success with using <a href="https://fedoraproject.org/wiki/Architectures/PowerPC?rd=Arch:PPC">Fedora&#8217;s PPC build</a>, which
has packages compiled for PPC already.  However, as Linux is intimidating for
many users, I chose to install RStudio Server on our lab server.</p>

<h1>Frequently Asked Questions</h1>

<ol>
<li><p>I get an error that says I&#8217;m <code>not in the sudoers file</code>:  This means that you don&#8217;t have access to install software on your machine.  Talk to your system administrator.</p></li>
<li><p>I don&#8217;t know if I&#8217;m running Ubuntu or Fedora.  How do I know which instructions to use?  Jokes aside, run <code>lsb_release -irc</code> in your terminal.</p></li>
</ol>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Faster SSCC  Access using Bash]]></title>
    <link href="http://frenchja.github.com/blog/2012/04/05/faster-sscc-access-using-bash/"/>
    <updated>2012-04-05T19:08:00-05:00</updated>
    <id>http://frenchja.github.com/blog/2012/04/05/faster-sscc-access-using-bash</id>
    <content type="html"><![CDATA[<p>I use SSH regularly to login remotely to servers for experiments and
data analysis.  For instance, <a href="http://www.it.northwestern.edu/research/sscc/">Northwestern&#8217;s Social Sciences Computing
Cluster</a> is available with an
SSH remote login and using <a href="https://en.wikipedia.org/wiki/X_Window_System">X11</a>
forwarding, I can access <a href="http://www.rstudio.org/">RStudio</a> and run analyses
that require more memory than my office iMac has.  However, logging into the
SSCC over SSH isn&#8217;t as quick and launching a program in Spotlight.</p>

<p>While browsing a friend&#8217;s .bashrc on Github, I realized I could
use a simple Bash function to speed things up.  Copy and paste the following
into Terminal:</p>

<figure class='code'><figcaption><span>Launching RStudio Remotely over SSH</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nb">echo</span> <span class="s2">&quot;function Rsscc() {</span>
</span><span class='line'><span class="s2">    ssh  -c arcfour,blowfish-cbc \</span>
</span><span class='line'><span class="s2">        -XC netid@hardin.it.northwestern.edu rstudio</span>
</span><span class='line'><span class="s2">    wait $1</span>
</span><span class='line'><span class="s2">    exit 0</span>
</span><span class='line'><span class="s2">}&quot;</span> &gt;&gt; ~/.profile
</span></code></pre></td></tr></table></div></figure>


<p>After you restart Terminal.app, you can launch RStudio remotely by typing
<code>Rsscc</code>, or whatever you renamed my function to.  In principle, you could also
create a simple menu for choosing among multiple servers or programs using a bit of
<a href="http://ss64.com/bash/read.html">read</a> and
<a href="http://tldp.org/LDP/Bash-Beginners-Guide/html/sect_07_03.html">case</a>.</p>

<figure class='code'><figcaption><span>Creating a Simple Command Menu</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>task_menu <span class="o">()</span> <span class="o">{</span>
</span><span class='line'>cat <span class="s">&lt;&lt; EOF</span>
</span><span class='line'><span class="s">$(tput setaf 5)Remote Login$(tput sgr0)</span>
</span><span class='line'><span class="s">$(tput setaf 5)============$(tput sgr0)</span>
</span><span class='line'>
</span><span class='line'><span class="s">Please choose one of the following:</span>
</span><span class='line'>
</span><span class='line'><span class="s">1) RStudio</span>
</span><span class='line'><span class="s">2) Stata</span>
</span><span class='line'>
</span><span class='line'><span class="s">EOF</span>
</span><span class='line'>  <span class="nb">read</span> -r choice
</span><span class='line'>  <span class="k">case</span> <span class="s2">&quot;$choice&quot;</span> in
</span><span class='line'>      1<span class="o">)</span> <span class="nv">task</span><span class="o">=</span><span class="s2">&quot;rstudio&quot;</span> ;;
</span><span class='line'>      2<span class="o">)</span> <span class="nv">task</span><span class="o">=</span><span class="s2">&quot;xstata&quot;</span> ;;
</span><span class='line'>      *<span class="o">)</span> <span class="nb">echo</span> <span class="s2">&quot;Please choose a number!&quot;</span> <span class="o">&amp;&amp;</span> task_menu ;;
</span><span class='line'>  <span class="k">esac</span>
</span><span class='line'><span class="k">fi</span>
</span><span class='line'>ssh -c arcfour,blowfish-cbc <span class="se">\</span>
</span><span class='line'>    -XC netid@hardin.it.northwestern.edu <span class="nv">$task</span>
</span><span class='line'>    <span class="nb">wait</span> <span class="nv">$1</span>
</span><span class='line'>    <span class="nb">exit </span>0
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><em>Note:</em>  This works best if you&#8217;re using an up-to-date version of X11, such as
<a href="http://xquartz.macosforge.org/trac/wiki">XQuartz</a> and are accessing the SSCC
using Ethernet.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Analyzing Qualtrics Data in R using Github Packages]]></title>
    <link href="http://frenchja.github.com/blog/2012/03/27/integrating-r-and-qualtrics/"/>
    <updated>2012-03-27T14:23:00-05:00</updated>
    <id>http://frenchja.github.com/blog/2012/03/27/integrating-r-and-qualtrics</id>
    <content type="html"><![CDATA[<p><a href="http://www.qualtrics.com/">Qualtrics</a> is an online survey platform similar to SurveyMonkey that is used by researchers to
collect data.  Until recently, one had to manually download the data in either SPSS or .csv format, making ongoing data
analysis difficult to check whether the trend of the incoming data supports the hypothesis.</p>

<p><a href="http://bryer.org/">Jason Bryer</a> has recently
developed an R package published to Github for downloading data from Qualtrics within R using the Qualtrics API
(<a href="https://github.com/jbryer/qualtrics">see his Github repo</a>).  Using this package, you can integrate your Qualtrics data
with other experimental data collected in the lab and, by running an Rscript as a cronjob, get daily updates for your
analyses in R.  I&#8217;ll demonstrate the use of this package below.</p>

<!-- more -->


<h2>Installing the Qualtrics Package from Github</h2>

<figure class='code'><figcaption><span>Installing Qualtrics  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'><span class="c1">#!/usr/bin/env Rscript</span>
</span><span class='line'><span class="c1"># Authors:  Jason A. French</span>
</span><span class='line'><span class="c1"># Email:    frenchja@u.northwestern.edu</span>
</span><span class='line'>install.packages<span class="p">(</span><span class="s">&#39;devtools&#39;</span><span class="p">,</span>dependencies<span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
</span><span class='line'>require<span class="p">(</span>devtools<span class="p">)</span>
</span><span class='line'>install_github<span class="p">(</span>repo<span class="o">=</span><span class="s">&#39;qualtrics&#39;</span><span class="p">,</span>username<span class="o">=</span><span class="s">&#39;jbryer&#39;</span><span class="p">)</span>
</span><span class='line'>require<span class="p">(</span>qualtrics<span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>If you wanted to distribute the Rscript to colleagues with different setups, you would use something like this:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'><span class="c1">#!/usr/bin/env Rscript</span>
</span><span class='line'><span class="c1"># Authors:  Jason A. French</span>
</span><span class='line'><span class="c1"># Email:    frenchja@u.northwestern.edu</span>
</span><span class='line'><span class="c1"># Check for devtools</span>
</span><span class='line'><span class="kr">if</span> <span class="p">(</span><span class="o">!</span>require<span class="p">(</span>devtools<span class="p">))</span> <span class="p">{</span>
</span><span class='line'>    warning<span class="p">(</span><span class="s">&#39;devtools not found. Attempting to install!&#39;</span><span class="p">)</span>
</span><span class='line'>    install.packages<span class="p">(</span><span class="s">&#39;devtools&#39;</span><span class="p">,</span>dependencies<span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
</span><span class='line'>    require<span class="p">(</span>devtools<span class="p">,</span>character.only<span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># Check Qualtrics Package from Github</span>
</span><span class='line'><span class="kr">if</span> <span class="p">(</span><span class="o">!</span>require<span class="p">(</span>qualtrics<span class="p">))</span> <span class="p">{</span>
</span><span class='line'>  warning<span class="p">(</span><span class="s">&#39;Qualtrics package not found&#39;</span><span class="p">)</span>
</span><span class='line'>  install_github<span class="p">(</span>repo<span class="o">=</span><span class="s">&#39;qualtrics&#39;</span><span class="p">,</span>username<span class="o">=</span><span class="s">&#39;jbryer&#39;</span><span class="p">)</span>
</span><span class='line'>  require<span class="p">(</span>qualtrics<span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Pulling Data from Qualtrics</h2>

<p><img class="right" src="http://frenchja.github.com/images/qualtricsid2.png">
First, you&#8217;ll need to find the Survey ID of the associated study on Qualtrics.  Access your <code>Account Settings</code> and click on
<code>Qualtrics IDs</code>.  From here, copy the entire ID into your R code (e.g., <code>SV_blahblah</code>).
<img class="center" src="http://frenchja.github.com/images/qualtricsid1.png"></p>

<p>Next, load the <code>qualtrics</code> package in R and pull the data using <code>getSurveyResults()</code>. <em>If you receive an error in R
regarding API permissions, you may need to email support@qualtrics.com and request API access.  The
R function accesses your survey using XML.</em></p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'><span class="c1"># Get Qualtrics Survey Data</span>
</span><span class='line'>qualtrics.data <span class="o">&lt;-</span> getSurveyResults<span class="p">(</span>username<span class="o">=</span>qualtrics.user<span class="p">,</span>
</span><span class='line'>                      password<span class="o">=</span>qualtrics.pass<span class="p">,</span>
</span><span class='line'>                      surveyid<span class="o">=</span><span class="s">&#39;SV_blahblah&#39;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Again, if you are distributing the analysis to collaborators, you may want to use a setup like below, which reads the user and
password securely.  If you want to automate this, you&#8217;ll obviously need hardcode your username and password.  At this time,
I don&#8217;t believe R has a hashing mechanism for passwords like Python, meaning you&#8217;ll need to have a plaintext password.</p>

<figure class='code'><figcaption><span>Password Protection for the Paranoid  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'><span class="c1"># Get Qualtrics Survey Data</span>
</span><span class='line'><span class="c1"># Not sure this will work in R.app.  Only in Terminal.app</span>
</span><span class='line'>get_password <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  cat<span class="p">(</span><span class="s">&quot;Qualtrics Password: &quot;</span><span class="p">)</span>
</span><span class='line'>  system<span class="p">(</span><span class="s">&quot;stty -echo&quot;</span><span class="p">)</span>
</span><span class='line'>  a <span class="o">&lt;-</span> readline<span class="p">()</span>
</span><span class='line'>  system<span class="p">(</span><span class="s">&quot;stty echo&quot;</span><span class="p">)</span>
</span><span class='line'>  cat<span class="p">(</span><span class="s">&quot;\n&quot;</span><span class="p">)</span>
</span><span class='line'>  <span class="kr">return</span><span class="p">(</span>a<span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'>qualtrics.user <span class="o">&lt;-</span> readline<span class="p">(</span>prompt<span class="o">=</span><span class="s">&#39;Enter your Qualtrics username&#39;</span><span class="p">)</span>
</span><span class='line'>qualtrics.pass <span class="o">&lt;-</span> get_password<span class="p">()</span>
</span><span class='line'>qualtrics.data <span class="o">&lt;-</span> getSurvey<span class="p">(</span>username<span class="o">=</span>qualtrics.user<span class="p">,</span>
</span><span class='line'>                      password<span class="o">=</span>qualtrics.pass<span class="p">,</span>
</span><span class='line'>                      surveyid<span class="o">=</span><span class="s">&#39;SV_blahblah&#39;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Outputting Data using xtable</h2>

<p>Now that we have our data pulled from Qualtrics, we can analyze it as if it were a regular R data.frame.
If you know your specific survey variables of interest, you&#8217;ll want to modify the code using <code>qualtrics.data[,c('Var1','Var2)]</code>.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='r'><span class='line'>require<span class="p">(</span>psych<span class="p">)</span>
</span><span class='line'>require<span class="p">(</span>xtable<span class="p">)</span>
</span><span class='line'>qualtrics.describe <span class="o">&lt;-</span> describe<span class="p">(</span>qualtrics.data<span class="p">)</span>
</span><span class='line'>qual.table <span class="o">&lt;-</span> xtable<span class="p">(</span>qualtrics.describe<span class="p">)</span>
</span><span class='line'>print.xtable<span class="p">(</span>qual.table<span class="p">,</span>type<span class="o">=</span><span class="s">&#39;html&#39;</span><span class="p">,</span>file<span class="o">=</span><span class="s">&#39;~/Desktop/Qualtrics.html&#39;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># Or...</span>
</span><span class='line'>qual.lm <span class="o">&lt;-</span> lm<span class="p">(</span>DV <span class="o">~</span> IV1<span class="o">*</span>IV2<span class="p">,</span> data<span class="o">=</span>qualtrics.data<span class="p">)</span>
</span><span class='line'>lm.table <span class="o">&lt;-</span> xtable<span class="p">(</span>qual.lm<span class="p">)</span>
</span><span class='line'>print.xtable<span class="p">(</span>lm.table<span class="p">,</span>type<span class="o">=</span><span class="s">&quot;html&quot;</span><span class="p">,</span>file<span class="o">=</span><span class="s">&#39;~/Desktop/Qualtrics.html&#39;</span><span class="p">,</span>append<span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Running an Rscript</h2>

<p>In order for your script to be run daily, it needs to be a) marked as executable (<a href="https://en.wikipedia.org/wiki/Filesystem_permissions">see here</a>)
and b) added to <a href="https://en.wikipedia.org/wiki/Cron">crontab</a>.  First, mark it
as executable:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>chmod +x ~/Qualtrics.R
</span></code></pre></td></tr></table></div></figure>


<p><em>Make sure that <code>#!/usr/bin/env Rscript</code> is at the top of your script!</em></p>

<p>Next, edit the system&#8217;s <a href="https://en.wikipedia.org/wiki/Cron">crontab</a> and add the script.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo nano /etc/crontab
</span><span class='line'>
</span><span class='line'>0 1 * * * ~/Qualtrics.R
</span></code></pre></td></tr></table></div></figure>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Graphing Error Bars for Repeated-Measures Variables with ggplot2]]></title>
    <link href="http://frenchja.github.com/blog/2012/03/07/graphing-error-bars-for-repeated-measures-variables-with-ggplot2/"/>
    <updated>2012-03-07T10:37:00-06:00</updated>
    <id>http://frenchja.github.com/blog/2012/03/07/graphing-error-bars-for-repeated-measures-variables-with-ggplot2</id>
    <content type="html"><![CDATA[<p>When presenting data, confidence intervals and error bars let the audience know the amount of uncertainty in the data, and
see how much of the variance is explained by the reported effect of an experiment.  While this is straightforward for
between-subject variables, it&#8217;s less clear for mixed- and repeated-measures designs.</p>

<p>Consider the following.  When running an ANOVA, the test accounts for three sources of variance:  1) the fixed effect of the condition, 2) the
ability of the participants, and 3) the random error, as data = model + error.  Plotting the repeated-measures without taking the
different sources of variance into consideration would result in overlapping error bars that include between-subject variability, confusing the presentation&#8217;s audience.
While the ANOVA partials out the differences between the participants and allow you to assess the effect of the
repeated-measure, computing a regular confidence interval by
multiplying the standard error and the F-statistic doesn&#8217;t work in this way.</p>

<p>Winston Chang has developed a set of R functions based on Morey (2008) and Cousineau (2005) on his wiki that help deal with this problem, where the sample variance is
computed for the normalized data, and then multiplied by the sample variances in each condition by M(M-1), where M is the
number of within-subject conditions.</p>

<p><a href="http://goo.gl/9rD3P">See his wiki here</a> for more info.</p>

<!-- more -->


<h3>References</h3>

<p>Morey, R. D. (2008). <em>Confidence Intervals from Normalized Data:  
A correction to Cousineau (2005).</em></p>

<p>Cousineau,D. (2005). <em>Confidence intervals in within‐subject
designs:A simpler solution to Loftus and Masson’s
method.</em></p>

<p>Loftus, G.R., &amp; Masson, M.E.J. (1994). <em>Using confidence
intervals in within‐subject designs.</em></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Using Figures within Tables in LaTeX]]></title>
    <link href="http://frenchja.github.com/blog/2012/01/17/using-figures-within-tables-in-latex/"/>
    <updated>2012-01-17T18:23:00-06:00</updated>
    <id>http://frenchja.github.com/blog/2012/01/17/using-figures-within-tables-in-latex</id>
    <content type="html"><![CDATA[<p>By using LaTeX to author APA manuscripts, researchers can address many problems associated with formatting their results
into tables and figures. For example, ANOVA tables can be readily generated using the
<a href="http://cran.r-project.org/web/packages/xtable/index.html"><code>xtable</code></a> package in R, and graphs from
<a href="http://cran.r-project.org/web/packages/ggplot2/index.html"><code>ggplot2</code></a> can be rendered <em>within</em> the manuscript using
<code>Sweave</code> (see <a href="https://en.wikipedia.org/wiki/Sweave">Wikipedia</a>). However, more complicated layouts can be difficult to
achieve.</p>

<p>In order to make test items or stimuli easier to understand, researchers occasionally organize examples in a table or
figure. Using the standard <code>\table</code> command in LaTeX, it&#8217;s possible to include figures in an individual table cell
without breaking the <a href="http://ctan.org/pkg/apa6">APA6.cls</a> package. For example: <!-- more --></p>

<figure class='code'><figcaption><span>Bottom-Aligned Figures in LaTeX Tables</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
</pre></td><td class='code'><pre><code class='latex'><span class='line'><span class="k">\begin</span><span class="nb">{</span>table<span class="nb">}</span>
</span><span class='line'>  [ht] <span class="k">\caption</span><span class="nb">{</span>Stimuli Category Explanations<span class="nb">}</span> <span class="k">\label</span><span class="nb">{</span>tab:stimuli<span class="nb">}</span>
</span><span class='line'>  <span class="k">\begin</span><span class="nb">{</span>tabular<span class="nb">}</span>
</span><span class='line'>      <span class="nb">{</span>lllll<span class="nb">}</span> <span class="k">\hline</span> Category <span class="nb">&amp;</span> Familiar Organism <span class="nb">&amp;</span> Growth Model <span class="nb">&amp;</span> Metamorphosis <span class="nb">&amp;</span> Figure <span class="k">\\</span>
</span><span class='line'>      <span class="k">\hline</span> <span class="k">\textbf</span><span class="nb">{</span>FDM<span class="nb">}</span> <span class="nb">&amp;</span> Yes <span class="nb">&amp;</span> Dramatic <span class="nb">&amp;</span> Yes <span class="nb">&amp;</span>
</span><span class='line'>      <span class="k">\includegraphics</span><span class="na">[width=1in]</span><span class="nb">{</span>&quot;Figure Stimuli&quot;/Fam-Meta-Dramatic<span class="nb">}</span> <span class="k">\\</span>
</span><span class='line'>      FDN <span class="nb">&amp;</span> Yes <span class="nb">&amp;</span> Dramatic <span class="nb">&amp;</span> No <span class="nb">&amp;</span>
</span><span class='line'>      <span class="k">\includegraphics</span><span class="na">[width=1in]</span><span class="nb">{</span>&quot;Figure Stimuli&quot;/Fam-Dramatic<span class="nb">}</span> <span class="k">\\</span>
</span><span class='line'>      FGM <span class="nb">&amp;</span> Yes <span class="nb">&amp;</span> Growth <span class="nb">&amp;</span> Yes <span class="nb">&amp;</span>
</span><span class='line'>      <span class="k">\includegraphics</span><span class="na">[width=1in]</span><span class="nb">{</span>&quot;Figure Stimuli&quot;/Fam-Meta-Growth<span class="nb">}</span> <span class="k">\\</span>
</span><span class='line'>      <span class="k">\textbf</span><span class="nb">{</span>FGN<span class="nb">}</span> <span class="nb">&amp;</span> Yes <span class="nb">&amp;</span> Growth <span class="nb">&amp;</span> No <span class="nb">&amp;</span>
</span><span class='line'>      <span class="k">\includegraphics</span><span class="na">[width=1in]</span><span class="nb">{</span>&quot;Figure Stimuli&quot;/Fam-Growth<span class="nb">}</span> <span class="k">\\</span>
</span><span class='line'>      FIM <span class="nb">&amp;</span> Yes <span class="nb">&amp;</span> Identical <span class="nb">&amp;</span> Yes <span class="nb">&amp;</span>
</span><span class='line'>      <span class="k">\includegraphics</span><span class="na">[width=1in]</span><span class="nb">{</span>&quot;Figure Stimuli&quot;/Fam-Meta-ID<span class="nb">}</span> <span class="k">\\</span>
</span><span class='line'>      FIN <span class="nb">&amp;</span> Yes <span class="nb">&amp;</span> Identical <span class="nb">&amp;</span> No <span class="nb">&amp;</span>
</span><span class='line'>      <span class="k">\includegraphics</span><span class="na">[width=1in]</span><span class="nb">{</span>&quot;Figure Stimuli&quot;/Fam-Identical<span class="nb">}</span> <span class="k">\\</span>
</span><span class='line'>      FSM <span class="nb">&amp;</span> Yes <span class="nb">&amp;</span> Species Change <span class="nb">&amp;</span> Yes <span class="nb">&amp;</span>
</span><span class='line'>      <span class="k">\includegraphics</span><span class="na">[width=1in]</span><span class="nb">{</span>&quot;Figure Stimuli&quot;/Fam-Meta-Species<span class="nb">}</span> <span class="k">\\</span>
</span><span class='line'>      FSN <span class="nb">&amp;</span> Yes <span class="nb">&amp;</span> Species Change <span class="nb">&amp;</span> No <span class="nb">&amp;</span>
</span><span class='line'>      <span class="k">\includegraphics</span><span class="na">[width=1in]</span><span class="nb">{</span>&quot;Figure Stimuli&quot;/Fam-Species<span class="nb">}</span> <span class="k">\\</span>
</span><span class='line'>      <span class="k">\textbf</span><span class="nb">{</span>UDM<span class="nb">}</span> <span class="nb">&amp;</span> No <span class="nb">&amp;</span> Dramatic <span class="nb">&amp;</span> Yes <span class="nb">&amp;</span>
</span><span class='line'>      <span class="k">\includegraphics</span><span class="na">[width=1in]</span><span class="nb">{</span>&quot;Figure Stimuli&quot;/Un2-Meta-Dramatic<span class="nb">}</span> <span class="k">\\</span>
</span><span class='line'>      UDN <span class="nb">&amp;</span> No <span class="nb">&amp;</span> Dramatic <span class="nb">&amp;</span> No <span class="nb">&amp;</span>
</span><span class='line'>      <span class="k">\includegraphics</span><span class="na">[width=1in]</span><span class="nb">{</span>&quot;Figure Stimuli&quot;/Un-Dramatic<span class="nb">}</span> <span class="k">\\</span>
</span><span class='line'>      UGM <span class="nb">&amp;</span> No <span class="nb">&amp;</span> Growth <span class="nb">&amp;</span> Yes <span class="nb">&amp;</span>
</span><span class='line'>      <span class="k">\includegraphics</span><span class="na">[width=1in]</span><span class="nb">{</span>&quot;Figure Stimuli&quot;/Un2-Meta-Growth<span class="nb">}</span> <span class="k">\\</span>
</span><span class='line'>      <span class="k">\textbf</span><span class="nb">{</span>UGN<span class="nb">}</span> <span class="nb">&amp;</span> No <span class="nb">&amp;</span> Growth <span class="nb">&amp;</span> No <span class="nb">&amp;</span>
</span><span class='line'>      <span class="k">\includegraphics</span><span class="na">[width=1in]</span><span class="nb">{</span>&quot;Figure Stimuli&quot;/Un-Growth<span class="nb">}</span> <span class="k">\\</span>
</span><span class='line'>      UIM <span class="nb">&amp;</span> No <span class="nb">&amp;</span> Identical <span class="nb">&amp;</span> Yes <span class="nb">&amp;</span>
</span><span class='line'>      <span class="k">\includegraphics</span><span class="na">[width=1in]</span><span class="nb">{</span>&quot;Figure Stimuli&quot;/Un2-Meta-ID<span class="nb">}</span> <span class="k">\\</span>
</span><span class='line'>      UIN <span class="nb">&amp;</span> No <span class="nb">&amp;</span> Identical <span class="nb">&amp;</span> No <span class="nb">&amp;</span>
</span><span class='line'>      <span class="k">\includegraphics</span><span class="na">[width=1in]</span><span class="nb">{</span>&quot;Figure Stimuli&quot;/Un-Identical<span class="nb">}</span> <span class="k">\\</span>
</span><span class='line'>      USM <span class="nb">&amp;</span> No <span class="nb">&amp;</span> Species Change <span class="nb">&amp;</span> Yes <span class="nb">&amp;</span>
</span><span class='line'>      <span class="k">\includegraphics</span><span class="na">[width=1in]</span><span class="nb">{</span>&quot;Figure Stimuli&quot;/Un2-Meta-Species<span class="nb">}</span> <span class="k">\\</span>
</span><span class='line'>      USN <span class="nb">&amp;</span> No <span class="nb">&amp;</span> Species Change <span class="nb">&amp;</span> No <span class="nb">&amp;</span>
</span><span class='line'>      <span class="k">\includegraphics</span><span class="na">[width=1in]</span><span class="nb">{</span>&quot;Figure Stimuli&quot;/Un-Species<span class="nb">}</span> <span class="k">\\</span>
</span><span class='line'>      USM <span class="nb">&amp;</span> No <span class="nb">&amp;</span> Species Change <span class="nb">&amp;</span> Yes <span class="nb">&amp;</span>
</span><span class='line'>      <span class="k">\includegraphics</span><span class="na">[width=1in]</span><span class="nb">{</span>&quot;Figure Stimuli&quot;/Un2-Meta-Species<span class="nb">}</span> <span class="k">\\</span>
</span><span class='line'>      <span class="k">\hline</span>
</span><span class='line'>  <span class="k">\end</span><span class="nb">{</span>tabular<span class="nb">}</span>
</span><span class='line'>  <span class="k">\tabfnt</span><span class="nb">{</span>Note: Bold categories are biologically correct growth models.<span class="nb">}</span>
</span><span class='line'><span class="k">\end</span><span class="nb">{</span>table<span class="nb">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Center-Aligned Figures</h2>

<p>However, the above code vertically aligned my images according to their bottom-edge, producing an awkward looking table.
Instead, we want the figures to be vertically centered. A Google search revealed the <a href="https://en.wikibooks.org/wiki/LaTeX/Tables#Vertically_centered_images">LaTeX
Wikibook</a>, which suggests a few methods to force
figures to vertically align according to their center. Below, I surround each <code>\includegraphics{}</code> command with the
<code>\parbox{}</code> command, which centers it along 1 unit of measurement, set to 12 pts. in my apa6 class options.</p>

<figure class='code'><figcaption><span>Center-Aligned Figures in LaTeX Tables  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
</pre></td><td class='code'><pre><code class='latex'><span class='line'><span class="k">\begin</span><span class="nb">{</span>table<span class="nb">}</span>
</span><span class='line'>  [ht] <span class="k">\caption</span><span class="nb">{</span>Stimuli Category Explanations<span class="nb">}</span> <span class="k">\label</span><span class="nb">{</span>tab:stimuli<span class="nb">}</span>
</span><span class='line'>  <span class="k">\begin</span><span class="nb">{</span>tabular<span class="nb">}</span>
</span><span class='line'>      <span class="nb">{</span>lllll<span class="nb">}</span> <span class="k">\hline</span> Stimuli Category <span class="nb">&amp;</span> Familiar Organism <span class="nb">&amp;</span> Growth Model <span class="nb">&amp;</span> Metamorphosis <span class="nb">&amp;</span> Figure <span class="k">\\</span>
</span><span class='line'>      <span class="k">\hline</span> <span class="k">\textbf</span><span class="nb">{</span>FDM<span class="nb">}</span> <span class="nb">&amp;</span> Yes <span class="nb">&amp;</span> Dramatic <span class="nb">&amp;</span> Yes <span class="nb">&amp;</span> <span class="k">\parbox</span><span class="na">[c]</span><span class="nb">{</span>1em<span class="nb">}{</span>
</span><span class='line'>      <span class="k">\includegraphics</span><span class="na">[width=1in]</span><span class="nb">{</span>&quot;Figure Stimuli&quot;/Fam-Meta-Dramatic<span class="nb">}}</span> <span class="k">\\</span>
</span><span class='line'>      FDN <span class="nb">&amp;</span> Yes <span class="nb">&amp;</span> Dramatic <span class="nb">&amp;</span> No <span class="nb">&amp;</span> <span class="k">\parbox</span><span class="na">[c]</span><span class="nb">{</span>1em<span class="nb">}{</span>
</span><span class='line'>      <span class="k">\includegraphics</span><span class="na">[width=1in]</span><span class="nb">{</span>&quot;Figure Stimuli&quot;/Fam-Dramatic<span class="nb">}}</span> <span class="k">\\</span>
</span><span class='line'>      FGM <span class="nb">&amp;</span> Yes <span class="nb">&amp;</span> Growth <span class="nb">&amp;</span> Yes <span class="nb">&amp;</span> <span class="k">\parbox</span><span class="na">[c]</span><span class="nb">{</span>1em<span class="nb">}{</span>
</span><span class='line'>      <span class="k">\includegraphics</span><span class="na">[width=1in]</span><span class="nb">{</span>&quot;Figure Stimuli&quot;/Fam-Meta-Growth<span class="nb">}}</span> <span class="k">\\</span>
</span><span class='line'>      <span class="k">\textbf</span><span class="nb">{</span>FGN<span class="nb">}</span> <span class="nb">&amp;</span> Yes <span class="nb">&amp;</span> Growth <span class="nb">&amp;</span> No <span class="nb">&amp;</span> <span class="k">\parbox</span><span class="na">[c]</span><span class="nb">{</span>1em<span class="nb">}{</span>
</span><span class='line'>      <span class="k">\includegraphics</span><span class="na">[width=1in]</span><span class="nb">{</span>&quot;Figure Stimuli&quot;/Fam-Growth<span class="nb">}}</span> <span class="k">\\</span>
</span><span class='line'>      FIM <span class="nb">&amp;</span> Yes <span class="nb">&amp;</span> Identical <span class="nb">&amp;</span> Yes <span class="nb">&amp;</span> <span class="k">\parbox</span><span class="na">[c]</span><span class="nb">{</span>1em<span class="nb">}{</span>
</span><span class='line'>      <span class="k">\includegraphics</span><span class="na">[width=1in]</span><span class="nb">{</span>&quot;Figure Stimuli&quot;/Fam-Meta-ID<span class="nb">}}</span> <span class="k">\\</span>
</span><span class='line'>      FIN <span class="nb">&amp;</span> Yes <span class="nb">&amp;</span> Identical <span class="nb">&amp;</span> No <span class="nb">&amp;</span> <span class="k">\parbox</span><span class="na">[c]</span><span class="nb">{</span>1em<span class="nb">}{</span>
</span><span class='line'>      <span class="k">\includegraphics</span><span class="na">[width=1in]</span><span class="nb">{</span>&quot;Figure Stimuli&quot;/Fam-Identical<span class="nb">}}</span> <span class="k">\\</span>
</span><span class='line'>      FSM <span class="nb">&amp;</span> Yes <span class="nb">&amp;</span> Species Change <span class="nb">&amp;</span> Yes <span class="nb">&amp;</span> <span class="k">\parbox</span><span class="na">[c]</span><span class="nb">{</span>1em<span class="nb">}{</span>
</span><span class='line'>      <span class="k">\includegraphics</span><span class="na">[width=1in]</span><span class="nb">{</span>&quot;Figure Stimuli&quot;/Fam-Meta-Species<span class="nb">}}</span> <span class="k">\\</span>
</span><span class='line'>      FSN <span class="nb">&amp;</span> Yes <span class="nb">&amp;</span> Species Change <span class="nb">&amp;</span> No <span class="nb">&amp;</span> <span class="k">\parbox</span><span class="na">[c]</span><span class="nb">{</span>1em<span class="nb">}{</span>
</span><span class='line'>      <span class="k">\includegraphics</span><span class="na">[width=1in]</span><span class="nb">{</span>&quot;Figure Stimuli&quot;/Fam-Species<span class="nb">}}</span> <span class="k">\\</span>
</span><span class='line'>      <span class="k">\textbf</span><span class="nb">{</span>UDM<span class="nb">}</span> <span class="nb">&amp;</span> No <span class="nb">&amp;</span> Dramatic <span class="nb">&amp;</span> Yes <span class="nb">&amp;</span> <span class="k">\parbox</span><span class="na">[c]</span><span class="nb">{</span>1em<span class="nb">}{</span>
</span><span class='line'>      <span class="k">\includegraphics</span><span class="na">[width=1in]</span><span class="nb">{</span>&quot;Figure Stimuli&quot;/Un2-Meta-Dramatic<span class="nb">}}</span> <span class="k">\\</span>
</span><span class='line'>      UDN <span class="nb">&amp;</span> No <span class="nb">&amp;</span> Dramatic <span class="nb">&amp;</span> No <span class="nb">&amp;</span> <span class="k">\parbox</span><span class="na">[c]</span><span class="nb">{</span>1em<span class="nb">}{</span>
</span><span class='line'>      <span class="k">\includegraphics</span><span class="na">[width=1in]</span><span class="nb">{</span>&quot;Figure Stimuli&quot;/Un-Dramatic<span class="nb">}}</span> <span class="k">\\</span>
</span><span class='line'>      UGM <span class="nb">&amp;</span> No <span class="nb">&amp;</span> Growth <span class="nb">&amp;</span> Yes <span class="nb">&amp;</span> <span class="k">\parbox</span><span class="na">[c]</span><span class="nb">{</span>1em<span class="nb">}{</span>
</span><span class='line'>      <span class="k">\includegraphics</span><span class="na">[width=1in]</span><span class="nb">{</span>&quot;Figure Stimuli&quot;/Un2-Meta-Growth<span class="nb">}}</span> <span class="k">\\</span>
</span><span class='line'>      <span class="k">\textbf</span><span class="nb">{</span>UGN<span class="nb">}</span> <span class="nb">&amp;</span> No <span class="nb">&amp;</span> Growth <span class="nb">&amp;</span> No <span class="nb">&amp;</span> <span class="k">\parbox</span><span class="na">[c]</span><span class="nb">{</span>1em<span class="nb">}{</span>
</span><span class='line'>      <span class="k">\includegraphics</span><span class="na">[width=1in]</span><span class="nb">{</span>&quot;Figure Stimuli&quot;/Un-Growth<span class="nb">}}</span> <span class="k">\\</span>
</span><span class='line'>      UIM <span class="nb">&amp;</span> No <span class="nb">&amp;</span> Identical <span class="nb">&amp;</span> Yes <span class="nb">&amp;</span> <span class="k">\parbox</span><span class="na">[c]</span><span class="nb">{</span>1em<span class="nb">}{</span>
</span><span class='line'>      <span class="k">\includegraphics</span><span class="na">[width=1in]</span><span class="nb">{</span>&quot;Figure Stimuli&quot;/Un2-Meta-ID<span class="nb">}}</span> <span class="k">\\</span>
</span><span class='line'>      UIN <span class="nb">&amp;</span> No <span class="nb">&amp;</span> Identical <span class="nb">&amp;</span> No <span class="nb">&amp;</span> <span class="k">\parbox</span><span class="na">[c]</span><span class="nb">{</span>1em<span class="nb">}{</span>
</span><span class='line'>      <span class="k">\includegraphics</span><span class="na">[width=1in]</span><span class="nb">{</span>&quot;Figure Stimuli&quot;/Un-Identical<span class="nb">}}</span> <span class="k">\\</span>
</span><span class='line'>      USM <span class="nb">&amp;</span> No <span class="nb">&amp;</span> Species Change <span class="nb">&amp;</span> Yes <span class="nb">&amp;</span> <span class="k">\parbox</span><span class="na">[c]</span><span class="nb">{</span>1em<span class="nb">}{</span>
</span><span class='line'>      <span class="k">\includegraphics</span><span class="na">[width=1in]</span><span class="nb">{</span>&quot;Figure Stimuli&quot;/Un2-Meta-Species<span class="nb">}}</span> <span class="k">\\</span>
</span><span class='line'>      USN <span class="nb">&amp;</span> No <span class="nb">&amp;</span> Species Change <span class="nb">&amp;</span> No <span class="nb">&amp;</span> <span class="k">\parbox</span><span class="na">[c]</span><span class="nb">{</span>1em<span class="nb">}{</span>
</span><span class='line'>      <span class="k">\includegraphics</span><span class="na">[width=1in]</span><span class="nb">{</span>&quot;Figure Stimuli&quot;/Un-Species<span class="nb">}}</span> <span class="k">\\</span>
</span><span class='line'>      USM <span class="nb">&amp;</span> No <span class="nb">&amp;</span> Species Change <span class="nb">&amp;</span> Yes <span class="nb">&amp;</span> <span class="k">\parbox</span><span class="na">[c]</span><span class="nb">{</span>1em<span class="nb">}{</span>
</span><span class='line'>      <span class="k">\includegraphics</span><span class="na">[width=1in]</span><span class="nb">{</span>&quot;Figure Stimuli&quot;/Un2-Meta-Species<span class="nb">}}</span> <span class="k">\\</span>
</span><span class='line'>      <span class="k">\hline</span>
</span><span class='line'>  <span class="k">\end</span><span class="nb">{</span>tabular<span class="nb">}</span>
</span><span class='line'>  <span class="k">\tabfnt</span><span class="nb">{</span>Note: Bold categories are biologically correct growth models.<span class="nb">}</span>
</span><span class='line'><span class="k">\end</span><span class="nb">{</span>table<span class="nb">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Output:
<img class="center" src="http://frenchja.github.com/images/origins.png" title="'Broken LaTeX Table'" ></p>

<p>By using <code>\parbox</code>, figures are now vertically aligned with text cells. However, with the addition of figures the table
is too long and we must span the table across 2-pages. To solve this, split the information across two tables. In this
case, I can split by the <strong>stimuli category</strong>.</p>

<p>Alternatively, <a href="http://www.edpsych.net/brian/">Brian Beitzel</a> also pointed out that we can invoke
<a href="http://tug.ctan.org/pkg/longtable"><code>longtable</code></a> as a class option in <a href="http://ctan.org/pkg/apa6">APA6.cls</a>, which allows
tables to span multiple pages.</p>
]]></content>
  </entry>
  
</feed>
